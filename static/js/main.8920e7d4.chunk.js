(this.webpackJsonpweb_spreadsheet=this.webpackJsonpweb_spreadsheet||[]).push([[0],{133:function(e,t,a){e.exports=a.p+"static/media/logo.5d5d9eef.svg"},134:function(e,t,a){},198:function(e,t,a){"use strict";a.r(t),function(e){var t=a(80);e.exports=function e(){var a=this;Object(t.a)(this,e),this.load_simulation=function(e,t,n,o,l){console.log("simulation type is: ",t),a.fill_col_headers(l,t);var s="";"attendance"==t||"grade_book"==t?s="academic":"employee_schedule_v1"==t||"employee_schedule_v2"==t||"progress_log"==t?s="management":"check_book"!=t&&"monthly_expense"!=t&&"monthly_income"!=t||(s="financing");var r=0;"attendance"==t?r=9:"grade_book"==t?r=17:"check_book"==t?r=7:"monthly_expense"==t||"monthly_income"==t?r=14:"employee_schedule_v1"==t?r=9:"employee_schedule_v2"==t?r=8:"progress_log"==t&&(r=7),fetch("/"+s+"/"+t+"/fetch-fifty-rows/"+e).then((function(e){return e.json()})).then((function(e){if(0===e.length)console.log("No data is fetched by fetchMoreRows function"),a.add_empty_rows(50,r,n,o);else{for(var l=0;l<e.length;l++){for(var s=[],c=0;c<r;c++)"attendance"==t&&(s[c]=0==c?e[l].ID:1==c?e[l].name:""),"grade_book"==t?(0==c&&(s[c]=e[l].ID),1==c&&(s[c]=e[l].name),2==c&&(s[c]=e[l].MP1),3==c&&(s[c]=e[l].MP2),4==c&&(s[c]=e[l].MP3),5==c&&(s[c]=e[l].MP4),6==c&&(s[c]=e[l].Lab1),7==c&&(s[c]=e[l].Lab2),8==c&&(s[c]=e[l].Lab3),9==c&&(s[c]=e[l].Lab4),10==c&&(s[c]=e[l].Lab5),11==c&&(s[c]=e[l].Lab6),12==c&&(s[c]=e[l].Lab7),13==c&&(s[c]=e[l].Exam1),14==c&&(s[c]=e[l].Exam2),15==c&&(s[c]=e[l].Final),16==c&&(s[c]=e[l].Overall)):"check_book"==t?(0==c&&(s[c]=e[l].id),1==c&&(s[c]=e[l].number),2==c&&(s[c]=e[l].date),3==c&&(s[c]=e[l].transaction),4==c&&(s[c]=e[l].withdraw),5==c&&(s[c]=e[l].deposit),6==c&&(s[c]=e[l].balance)):"monthly_expense"==t?(0==c&&(s[c]=e[l].id),1==c&&(s[c]=e[l].expenses),2==c&&(s[c]=e[l].Jan),3==c&&(s[c]=e[l].Feb),4==c&&(s[c]=e[l].Mar),5==c&&(s[c]=e[l].Apr),6==c&&(s[c]=e[l].May),7==c&&(s[c]=e[l].Jun),8==c&&(s[c]=e[l].Jul),9==c&&(s[c]=e[l].Aug),10==c&&(s[c]=e[l].Sep),11==c&&(s[c]=e[l].Oct),12==c&&(s[c]=e[l].Nov),13==c&&(s[c]=e[l].Dec)):"monthly_income"==t?(0==c&&(s[c]=e[l].id),1==c&&(s[c]=e[l].income_type),2==c&&(s[c]=e[l].Jan),3==c&&(s[c]=e[l].Feb),4==c&&(s[c]=e[l].Mar),5==c&&(s[c]=e[l].Apr),6==c&&(s[c]=e[l].May),7==c&&(s[c]=e[l].Jun),8==c&&(s[c]=e[l].Jul),9==c&&(s[c]=e[l].Aug),10==c&&(s[c]=e[l].Sep),11==c&&(s[c]=e[l].Oct),12==c&&(s[c]=e[l].Nov),13==c&&(s[c]=e[l].Dec)):"employee_schedule_v1"==t?(0==c&&(s[c]=e[l].emp_id),1==c&&(s[c]=e[l].name),2==c&&(s[c]=e[l].Monday),3==c&&(s[c]=e[l].Tuesday),4==c&&(s[c]=e[l].Wednesday),5==c&&(s[c]=e[l].Thursday),6==c&&(s[c]=e[l].Friday),7==c&&(s[c]=e[l].Saturday),8==c&&(s[c]=e[l].Sunday)):"employee_schedule_v2"==t?(1==c&&(s[c]=e[l].time_slot),2==c&&(s[c]=e[l].Monday),3==c&&(s[c]=e[l].Tuesday),4==c&&(s[c]=e[l].Wednesday),5==c&&(s[c]=e[l].Thursday),6==c&&(s[c]=e[l].Friday),7==c&&(s[c]=e[l].Saturday),8==c&&(s[c]=e[l].Sunday)):"progress_log"==t&&(0==c&&(s[c]=e[l].task_id),1==c&&(s[c]=e[l].task),2==c&&(s[c]=e[l].deadline),3==c&&(s[c]=e[l].emp_id),4==c&&(s[c]=e[l].name),5==c&&(s[c]=e[l].hour_spent),6==c&&(s[c]=e[l].progress));n[l]=s,o[l]=s.slice()}a.add_empty_rows(10,r,n,o)}}))},this.load_simulation_v2=function(e,t,n,o,l){console.log("simulation type is: ",t),a.fill_col_headers(l,t);var s="";"attendance"==t||"grade_book"==t||"student_status"==t?s="academic":"employee_schedule_v1"==t||"employee_schedule_v2"==t||"progress_log"==t?s="management":"check_book"!=t&&"monthly_expense"!=t&&"monthly_income"!=t||(s="financing");var r=0;"attendance"==t?r=9:"grade_book"==t?r=17:"check_book"==t?r=7:"monthly_expense"==t||"monthly_income"==t?r=14:"employee_schedule_v1"==t?r=9:"employee_schedule_v2"==t?r=8:"progress_log"==t?r=7:"student_status"==t&&(r=6),fetch("/"+s+"/"+t+"/fetch-fifty-rows/"+e).then((function(e){return e.json()})).then((function(e){if(0===e.length)console.log("No data is fetched by fetchMoreRows function"),a.add_empty_rows(50,r,n,o);else{console.log(e);for(var l=0;l<e.length;l++){for(var s=[],c=0;c<r;c++)"attendance"==t&&(s[c]=0==c?e[l].ID:1==c?e[l].name:""),"grade_book"==t?(0==c&&(s[c]=e[l].ID),1==c&&(s[c]=e[l].name),2==c&&(s[c]=e[l].MP1),3==c&&(s[c]=e[l].MP2),4==c&&(s[c]=e[l].MP3),5==c&&(s[c]=e[l].MP4),6==c&&(s[c]=e[l].Lab1),7==c&&(s[c]=e[l].Lab2),8==c&&(s[c]=e[l].Lab3),9==c&&(s[c]=e[l].Lab4),10==c&&(s[c]=e[l].Lab5),11==c&&(s[c]=e[l].Lab6),12==c&&(s[c]=e[l].Lab7),13==c&&(s[c]=e[l].Exam1),14==c&&(s[c]=e[l].Exam2),15==c&&(s[c]=e[l].Final),16==c&&(s[c]=e[l].Overall)):"check_book"==t?(0==c&&(s[c]=e[l].id),1==c&&(s[c]=e[l].number),2==c&&(s[c]=e[l].date),3==c&&(s[c]=e[l].transaction),4==c&&(s[c]=e[l].withdraw),5==c&&(s[c]=e[l].deposit),6==c&&(s[c]=e[l].balance)):"monthly_expense"==t?(0==c&&(s[c]=e[l].id),1==c&&(s[c]=e[l].expenses),2==c&&(s[c]=e[l].Jan),3==c&&(s[c]=e[l].Feb),4==c&&(s[c]=e[l].Mar),5==c&&(s[c]=e[l].Apr),6==c&&(s[c]=e[l].May),7==c&&(s[c]=e[l].Jun),8==c&&(s[c]=e[l].Jul),9==c&&(s[c]=e[l].Aug),10==c&&(s[c]=e[l].Sep),11==c&&(s[c]=e[l].Oct),12==c&&(s[c]=e[l].Nov),13==c&&(s[c]=e[l].Dec)):"monthly_income"==t?(0==c&&(s[c]=e[l].id),1==c&&(s[c]=e[l].income_type),2==c&&(s[c]=e[l].Jan),3==c&&(s[c]=e[l].Feb),4==c&&(s[c]=e[l].Mar),5==c&&(s[c]=e[l].Apr),6==c&&(s[c]=e[l].May),7==c&&(s[c]=e[l].Jun),8==c&&(s[c]=e[l].Jul),9==c&&(s[c]=e[l].Aug),10==c&&(s[c]=e[l].Sep),11==c&&(s[c]=e[l].Oct),12==c&&(s[c]=e[l].Nov),13==c&&(s[c]=e[l].Dec)):"employee_schedule_v1"==t?(0==c&&(s[c]=e[l].emp_id),1==c&&(s[c]=e[l].name),2==c&&(s[c]=e[l].Monday),3==c&&(s[c]=e[l].Tuesday),4==c&&(s[c]=e[l].Wednesday),5==c&&(s[c]=e[l].Thursday),6==c&&(s[c]=e[l].Friday),7==c&&(s[c]=e[l].Saturday),8==c&&(s[c]=e[l].Sunday)):"employee_schedule_v2"==t?(1==c&&(s[c]=e[l].time_slot),2==c&&(s[c]=e[l].Monday),3==c&&(s[c]=e[l].Tuesday),4==c&&(s[c]=e[l].Wednesday),5==c&&(s[c]=e[l].Thursday),6==c&&(s[c]=e[l].Friday),7==c&&(s[c]=e[l].Saturday),8==c&&(s[c]=e[l].Sunday)):"progress_log"==t?(0==c&&(s[c]=e[l].task_id),1==c&&(s[c]=e[l].task),2==c&&(s[c]=e[l].deadline),3==c&&(s[c]=e[l].emp_id),4==c&&(s[c]=e[l].name),5==c&&(s[c]=e[l].hour_spent),6==c&&(s[c]=e[l].progress)):"student_status"==t&&(0==c&&(s[c]=e[l].ID),1==c&&(s[c]=e[l].name),2==c&&(s[c]=e[l].num_tardy),3==c&&(s[c]=e[l].num_abs),4==c&&(s[c]=e[l].dis_action),5==c&&(s[c]=e[l].status));n[l]=s,o[l]=s.slice()}a.add_empty_rows(10,r,n,o)}}))},this.fill_col_headers=function(e,t){"attendance"==t&&(e.push("ID"),e.push("Name"),e.push("Monday"),e.push("Tuesday"),e.push("Wednesday"),e.push("Thursday"),e.push("Friday"),e.push("Saturday"),e.push("Sunday")),"grade_book"==t&&(e.push("ID"),e.push("Name"),e.push("MP1"),e.push("MP2"),e.push("MP3"),e.push("MP4"),e.push("Lab1"),e.push("Lab2"),e.push("Lab3"),e.push("Lab4"),e.push("Lab5"),e.push("Lab6"),e.push("Lab7"),e.push("Exam1"),e.push("Exam2"),e.push("Final"),e.push("Overall")),"check_book"==t&&(e.push("ID"),e.push("number"),e.push("date"),e.push("Transaction"),e.push("Withdraw"),e.push("Deposit"),e.push("Balance")),"monthly_expense"==t&&(e.push("ID"),e.push("expenses"),e.push("Jan"),e.push("Feb"),e.push("Mar"),e.push("Apr"),e.push("May"),e.push("Jun"),e.push("Jul"),e.push("Aug"),e.push("Sep"),e.push("Oct"),e.push("Nov"),e.push("Dec")),"monthly_income"==t&&(e.push("ID"),e.push("income"),e.push("Jan"),e.push("Feb"),e.push("Mar"),e.push("Apr"),e.push("May"),e.push("Jun"),e.push("Jul"),e.push("Aug"),e.push("Sep"),e.push("Oct"),e.push("Nov"),e.push("Dec")),"employee_schedule_v1"==t&&(e.push("Employee ID"),e.push("Name"),e.push("Monday"),e.push("Tuesday"),e.push("Wednesday"),e.push("Thursday"),e.push("Friday"),e.push("Saturday"),e.push("Sunday")),"employee_schedule_v2"==t&&(e.push("Time Slot"),e.push("Monday"),e.push("Tuesday"),e.push("Wednesday"),e.push("Thursday"),e.push("Friday"),e.push("Saturday"),e.push("Sunday")),"progress_log"==t&&(e.push("Task ID"),e.push("Task"),e.push("Deadline"),e.push("Employee ID"),e.push("Name"),e.push("Hours Spent"),e.push("Status")),"student_status"==t&&(e.push("ID"),e.push("Name"),e.push("Tardy"),e.push("Absent"),e.push("Disciplinary Action"),e.push("Status"))},this.add_empty_rows=function(e,t,a,n){console.log("adding more rows!");for(var o=0;o<e;o++){for(var l=[],s=0;s<t;s++)l.push("");a[a.length]=l,n[n.length]=l.slice()}}}}.call(this,a(452)(e))},339:function(e,t,a){e.exports=a(467)},344:function(e,t,a){},438:function(e,t){},467:function(e,t,a){"use strict";a.r(t);var n,o,l,s=a(0),r=a.n(s),c=a(79),i=a.n(c),u=(a(344),a(80)),h=a(90),d=a(92),m=a(91),g=(a(133),a(134),a(115)),p=(a(345),a(350),a(126)),f=a(68),_=a(58),b=a.n(_),E=a(85),y=a(17),S=a(81),k=(a(47),a(168),a(335)),v=a(468),C=a(469),O=a(470),R=a(471),M=a(472),w=a(473),T=a(474),N=a(491),I=a(475),x=a(476),j=a(477),A=a(478),H=a(479),D=a(480),L=a(481),P=a(482),U=a(127),z=a(136),G=a(137),F=a(111),B=a.n(F),J=a(135),W=(new J,{layout_changed:!1,changes:[]}),V=[],Q=[],Y=0,K=[],X=[],q=[],$=0,Z=[],ee=[],te=!1,ae=51,ne=!1,oe=-1,le=-1,se="",re="",ce=-1,ie=-1,ue="",he="",de={data:[],try_message:"SENT MESSAGE! SUCCESS!",user:""},me="",ge=function(e){Object(d.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(u.a)(this,a),(e=t.call(this)).request_shared_lock=function(){var t={row:ce,col:ie};e.socket.emit("REQUEST_SHARED_LOCK",t)},e.request_exclusive_lock=function(t,a){var n={row:t,col:a};e.socket.emit("REQUEST_EXCLUSIVE_LOCK",n)},e.toggleNavbar=function(){e.setState({collapsed:!e.state.collapsed})},e.toggleExclusiveLockReject=function(){e.setState({isExclusiveLockRejectOpen:!e.state.isExclusiveLockRejectOpen})},e.toggleSharedLockReject=function(){e.setState({isSharedLockRejectOpen:!e.state.isSharedLockRejectOpen})},e.toggleConflictModal=function(){e.setState({isConflictModalOpen:!e.state.isConflictModalOpen})},e.toggleShowHistory=function(){e.setState({isShowHistoryOpen:!e.state.isShowHistoryOpen})},e.toggleUserNamePrompt=function(){e.setState({isUserNamePromptOpen:!e.state.isUserNamePromptOpen})},e.fetchMoreData=function(){if(e.state.items.length>=Math.ceil(e.state.rows.length/50))return e.setState({hasMore:!1}),void console.log("the final number of page is: "+Math.ceil(e.state.rows.length/50));if(0==e.state.load_from_buffer_to_matrix)e.setState({load_from_buffer_to_matrix:!0}),0==X.length&&e.fetchMoreRows(50);else{for(var t=0;t<50;t++)if(t<X.length){for(var a={},n=0;n<=0;n++)if(0==n){var o={text:X[t].id};a.id=o}else{var l={text:X[t]["attribute"+n]};a["attr"+n]=l}K[t]=a}else{console.log("i is greater than 50 now");var s={};for(n=0;n<=0;n++)if(0==n){s.id={text:""}}else{s["attr"+n]={text:""}}K[t]=s}e.fetchMoreRows(ae),ae+=50,console.log("data matrix at fetch more data is: "),console.log(K)}setTimeout((function(){e.setState({items:e.state.items.concat(Array.from({length:1}))})}),1500)},e.fetchMoreRows=function(e){X=[],q=[],fetch("/database/fetch-fifty-rows/"+e).then((function(e){return e.json()})).then((function(e){if(0===e.length)console.log("No data is fetched by fetchMoreRows function"),!0;else{!1;for(var t=0;t<e.length;t++){for(var a=[],n=1;n<=7;n++)a[n-1]=e[t]["attribute"+n];X[t]=a,q[t]=a.slice()}console.log("the buffer is: "),console.log(X)}}))},e.display=function(){if(he="",ue=e.state.transaction_mode?r.a.createElement(k.a,{size:"lg",className:"display-button",color:"primary",onClick:e.end_transaction},"End Transaction"):r.a.createElement(k.a,{size:"lg",className:"display-button",color:"primary",onClick:e.start_transaction},"Start Transaction"),e.setState({data_original:e.state.data_original.concat(X)}),Z=Z.concat(q),e.fetchMoreRows(ae),ae+=50,0==V.length)for(var t=0;t<Z[0].length;t++)V[t]=Z[0][t]},e.redirect_import=function(){e.setState({redirect_import_page:!0})},e.handleScroll=function(t){t.target.scrollHeight-t.target.scrollTop===t.target.clientHeight&&e.display(),$=t.target.scrollTop},e.show_state=function(){console.log(ee),console.log(te)},e.sendMessage=function(t){e.socket.emit("SEND_MESSAGE",t)},e.check_cell_change=function(){if(te){var t="Y";e.state.transaction_mode||(t="N");var a="";a=isNaN(ee[0][3])?"STR":"DIGIT",Q.push(["edit_cell",ee[0][0],ee[0][1],a,ee[0][0]+1,V[ee[0][1]],t]),console.log("chn_copy is check cell change is===============================: ",ee),e.request_exclusive_lock(ee[0][0],ee[0][1]),de.user=e.state.user_name;var n=[],o=parseInt(ee[0][0])+1,l=parseInt(ee[0][1])+1,s=ee[0][3];n[0]=l,n[1]=s,n[2]=o,de.data.push(n),console.log("pending changes are000: ",de),te=!1}else console.log("no changed detected")},e.cell_read_only=function(t,a){e.hotTableComponent.current.hotInstance.updateSettings({cells:function(e,n,o){var l={};return e==t&&n==a&&(l.readOnly="true"),l}})},e.hangleUsername=function(t){e.setState(Object(y.a)({},t.target.name,t.target.value))},e.send_default_username=function(){e.socket.emit("SEND_USERNAME",{user_name:"anonymous user"}),e.toggleUserNamePrompt()},e.onUserNameSubmit=function(t){t.preventDefault(),console.log("call username");var a={user_name:e.state.user_name};e.socket.emit("SEND_USERNAME",a),e.toggleUserNamePrompt()},e.resolve_conflict=function(t){t.preventDefault(),Z[oe][le]=se,e.state.data_original[oe][le]=se,oe=-1,le=-1,se=-1,re="",e.toggleConflictModal()},e.start_transaction=function(){de.data=[],e.setState({transaction_mode:!0}),ue=r.a.createElement(k.a,{size:"lg",className:"display-button",color:"primary",onClick:e.end_transaction},"End Transaction")},e.commit_transaction=function(){if(console.log("pending changes are111: ",de),de.data.length>0){e.sendMessage(de);var t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({pending_changes:de})};fetch("/database/update-content",t)}},e.end_transaction=function(){setTimeout((function(){e.commit_transaction()}),500),e.setState({transaction_mode:!1}),ue=r.a.createElement(k.a,{size:"lg",className:"display-button",color:"primary",onClick:e.start_transaction},"Start Transaction"),e.socket.emit("FINISH_TRANSACTION")},e.track_action=function(t,a){var n="Y";e.state.transaction_mode||(n="N");var o=Date.now()/1e3-Y;if(Y=Date.now()/1e3,o>3)if(Q.length>0&&"idle"==Q[Q.length-1][0]){var l=Q[Q.length-1][1];Q.pop(),Q.push(["idle",parseInt(o)+l,null,null,null,null,n])}else Q.push(["idle",parseInt(o),null,null,null,null,n]);if(W.layout_changed){Q.length>0&&"idle"==Q[Q.length-1][0]&&Q.pop();for(var s=0;s<W.changes.length;s++){var r=W.changes[s][0],c=W.changes[s][1],i=W.changes[s][2];Q.push([r,i,c,null,null,null,n])}W.changes.length=0,W.layout_changed=!1}if("scroll"==a){var u=$-t.target.scrollTop,h=Q.length;if(u>0)if(h>=1&&"up_scroll_l"===Q[h-1][0]);else if(h>=5){var d=!0;for(s=0;s<5;s++)if("up_scroll_s"!==Q[h-1-s][0]){d=!1;break}if(d){for(s=0;s<5;s++)Q.pop();Q.push(["up_scroll_l",null,null,null,null,null,n])}else Q.push(["up_scroll_s",null,null,null,null,null,n])}else Q.push(["up_scroll_s",null,null,null,null,null,n]);else if(u<0)if(h>=1&&"down_scroll_l"===Q[h-1][0]);else if(h>=5){var m=!0;for(s=0;s<5;s++)if("down_scroll_s"!==Q[h-1-s][0]){m=!1;break}if(m){for(s=0;s<5;s++)Q.pop();Q.push(["down_scroll_l",null,null,null,null,null,n])}else Q.push(["down_scroll_s",null,null,null,null,null,n])}else Q.push(["down_scroll_s",null,null,null,null,null,n]);e.handleScroll(t)}else"click"==a?(ne&&e.state.transaction_mode&&(ie<0?Q.push(["select_r",ce,null,null,null,null,n]):ce<0?Q.push(["select_c",ie,null,null,null,null,n]):Q.push([a,ce,ie,null,ce+1,V[ie],n]),ne=!1),e.check_cell_change()):"key_press"==a&&(te&&("Enter"==t.key?Q.push(["keyPress_enter",ee[0][0],ee[0][1],null,ee[0][0]+1,V[ee[0][1]],n]):"Tab"==t.key?Q.push(["keyPress_tab",ee[0][0],ee[0][1],null,ee[0][0]+1,V[ee[0][1]],n]):Q.push(["keyPress",ee[0][0],ee[0][1],null,ee[0][0]+1,V[ee[0][1]],n])),e.check_cell_change());console.log(Q)},e.store_training_data=function(){Q.push(["END_TRAINING_DATA",null,null,null,null,null,"END"]);var e={user_actions:Q},t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action_package:e})};fetch("/database/send-training-data",t)},e.id="hot",e.hotTableComponent=r.a.createRef(),e.state={collapsed:!1,rows:[],cols:[],attri:[],items:Array.from({length:0}),hasMore:!1,load_from_buffer_to_matrix:!1,hasMoreResult:!1,resultItems:Array.from({length:0}),load_result_from_buffer_to_matrix:!1,redirect_import_page:!1,import_page_link:"/result",data_original:[],check_cell_update:!1,test_block:"ORIGINAL MESSAGE",users:[],user_text_block:"",isUserNamePromptOpen:!0,user_name:"",edit_message:"Last Edit: No modification yet",history:[],isShowHistoryOpen:!1,isConflictModalOpen:!1,transaction_mode:!1,isSharedLockRejectOpen:!1,isExclusiveLockRejectOpen:!1},e.socket=B()("localhost:3001"),e.socket.on("RECEIVE_MESSAGE",(function(e){p(e)})),e.socket.on("RECEIVE_ID",(function(e){l(e)})),e.socket.on("REQUEST_SHARED_REJECT",(function(e){d(e)})),e.socket.on("REQUEST_SHARED_ACCEPT",(function(e){var t=e.row,a=e.col;i(t,a)})),e.socket.on("REQUEST_EXCLUSIVE_REJECT",(function(e){var t=e.row,a=e.col;m(t,a)})),e.socket.on("REQUEST_EXCLUSIVE_ACCEPT",(function(e){var t=e.row,a=e.col;e.id!==me&&h(t,a)})),e.socket.on("CHANGE_CURRENT_USER",(function(e){g(e)})),e.socket.on("ADD_NEW_USER",(function(e){s(e)})),e.socket.on("RECEIVE_FREED_CELLS",(function(e){o(e)})),e.socket.on("UPDATE_EDIT_MESSAGE",(function(e){n(e)}));var n=function(t){e.setState({edit_message:t.new_message,history:t.history})},o=function(t){var a=t.free_cells,n=t.disconnect;console.log("the free cells are ",a);for(var o=0;o<a.length;o++){var l=a[o];if(l[0]<Z.length){var s=e.hotTableComponent.current.hotInstance.getDataAtCell(l[0],l[1]);if("*"==s[0]){var r=s.substring(1);e.hotTableComponent.current.hotInstance.setDataAtCell(l[0],l[1],r)}"-----"==s&&1==n&&(Z[(l[0],l[1])]=e.state.data_original[(l[0],l[1])])}}c()},l=function(e){me=e},s=function(t){e.setState({history:t.history}),g(t.current_users)},c=function(){console.log("setting to read only..."),e.hotTableComponent.current.hotInstance.updateSettings({cells:function(e,t,a){var n={};return null===Z[e][t]||"-----"!=Z[e][t]&&"*"!==Z[e][t].charAt(0)||(n.readOnly="true"),n}})},i=function(t,a){if(t<Z.length){var n=e.hotTableComponent.current.hotInstance.getDataAtCell(t,a);if("*"===n.charAt(0))return;var o="*"+n;e.hotTableComponent.current.hotInstance.setDataAtCell(t,a,o),c()}},h=function(t,a){if(t<Z.length){console.log(t),console.log(a);e.hotTableComponent.current.hotInstance.setDataAtCell(t,a,"-----"),c()}},d=function(t){e.setState({isSharedLockRejectOpen:!e.state.isSharedLockRejectOpen})},m=function(t){e.setState({isExclusiveLockRejectOpen:!e.state.isExclusiveLockRejectOpen})},g=function(t){e.setState({users:t});for(var a="Currently Online: ",n=0;n<e.state.users.length;n++)n==e.state.users.length-1?a+=e.state.users[n]:a+=e.state.users[n]+", ";e.setState({user_text_block:a})},p=function(t){for(var a=t.data,n=0;n<a.length;n++){var o=a[n][0]-1,l=a[n][1],s=a[n][2]-1;s<Z.length?(Z[s][o]=l,e.state.data_original[s][o]=l):s+1<ae&&(s++,q[s+50-ae][o]!=l&&(q[s+50-ae][o]=l,X[s+50-ae][o]=l))}console.log("after socket, buffer_copy is: ",q),e.setState({test_block:t.try_message})};return e.toggleUserNamePrompt=e.toggleUserNamePrompt.bind(),e.toggleShowHistory=e.toggleShowHistory.bind(),e.toggleConflictModal=e.toggleConflictModal.bind(),e.toggleNavbar=e.toggleNavbar.bind(),e.toggleSharedLockReject=e.toggleSharedLockReject.bind(),e.toggleExclusiveLockReject=e.toggleExclusiveLockReject.bind(),e}return Object(h.a)(a,[{key:"componentDidMount",value:function(){var e=Object(E.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Y=Date.now()/1e3,he=r.a.createElement(k.a,{size:"lg",className:"display-button",color:"primary",onClick:this.display},"Display Dataset"),this.hotTableComponent.current.hotInstance.addHook("afterChange",(function(e,t){"edit"===t&&(console.log(e),e[0][2]!==e[0][3]&&"*"!==e[0][3].charAt(0)&&"-----"!==e[0][3]&&(console.log("differ!"),ee=e,te=!0,-1,-1,ne=!1))})),this.hotTableComponent.current.hotInstance.addHook("afterBeginEditing",(function(e,t){e,t})),this.hotTableComponent.current.hotInstance.addHook("afterSelection",(function(e,t,a,n,o,l){ce=e,ie=t,ne=!0})),this.hotTableComponent.current.hotInstance.addHook("afterCreateRow",(function(e,t,a){console.log("insert index is: ",e),"ContextMenu.rowBelow"==a?(W.layout_changed=!0,W.changes.push(["insert_r","below",e])):(W.layout_changed=!0,W.changes.push(["insert_r","above",e]))})),this.hotTableComponent.current.hotInstance.addHook("afterCreateCol",(function(e,t,a){console.log("insert index is: ",e),"ContextMenu.columnRight"==a?(W.layout_changed=!0,W.changes.push(["insert_c","right",e])):(W.layout_changed=!0,W.changes.push(["insert_c","left",e]))})),this.hotTableComponent.current.hotInstance.addHook("afterRemoveRow",(function(e,t,a,n){W.layout_changed=!0,W.changes.push(["remove_r",null,e])})),this.hotTableComponent.current.hotInstance.addHook("afterRemoveCol",(function(e,t,a,n){W.layout_changed=!0,W.changes.push(["remove_c",null,e])})),document.addEventListener("keydown",this.handleEnter,!1),X=[],q=[],"/database/fetch-fifty-rows/1",fetch("/database/fetch-fifty-rows/1").then((function(e){return e.json()})).then((function(e){if(0===e.length)console.log("No data is fetched by fetchMoreRows function"),!0;else{!1;for(var t=0;t<e.length;t++){for(var a=[],n=1;n<=7;n++)a[n-1]=e[t]["attribute"+n];X[t]=a,q[t]=a.slice()}console.log("the buffer is: "),console.log(X)}}));case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){this.socket.disconnect()}},{key:"render",value:function(){var e,t=this;return this.state.redirect_import_page?r.a.createElement(f.a,{to:this.state.import_page_link}):r.a.createElement("div",{onClick:function(e){return t.track_action(e,"click")},onKeyUp:function(e){return t.track_action(e,"key_press")},className:"App"},r.a.createElement("script",{src:"node_modules/handsontable/dist/handsontable.full.min.js"}),r.a.createElement("link",{href:"node_modules/handsontable/dist/handsontable.full.min.css",rel:"stylesheet",media:"screen"}),r.a.createElement(v.a,{className:"logo-jumbo"}),r.a.createElement("div",null,r.a.createElement(v.a,null,r.a.createElement(C.a,{color:"faded",light:!0},r.a.createElement(O.a,{onClick:this.toggleNavbar,className:"mr-2"}),r.a.createElement(R.a,{isOpen:this.state.collapsed,navbar:!0},r.a.createElement(M.a,{tabs:!0},r.a.createElement(w.a,null,r.a.createElement(T.a,{href:"/result"},"Import Page"))))),r.a.createElement("h1",{className:"display-3"},"Hi ",this.state.user_name,", welcome to spreadsheet web!"),r.a.createElement("p",{className:"lead"},"This is a simple web interface that allows you to upload spreadsheets and retrieve data."),r.a.createElement("hr",{className:"my-2"}),r.a.createElement("p",null,this.state.user_text_block),r.a.createElement("p",{className:"lead"},r.a.createElement(k.a,{size:"lg",className:"display-button",color:"info",onClick:this.toggleShowHistory},"Edit History"),"\xa0\xa0\xa0\xa0",he,"\xa0\xa0\xa0\xa0",ue,"\xa0\xa0\xa0\xa0","","\xa0\xa0\xa0\xa0",r.a.createElement(k.a,{size:"lg",className:"display-button",color:"info",onClick:this.store_training_data},"Complete Simulation")),r.a.createElement("p",null,this.state.edit_message),r.a.createElement(N.a,{size:"lg",isOpen:this.state.isUserNamePromptOpen},r.a.createElement(I.a,null,"Please enter your costomized username, or choose the default random username "),r.a.createElement(x.a,null,r.a.createElement(j.a,{onSubmit:this.onUserNameSubmit},r.a.createElement(A.a,null,r.a.createElement(H.a,{for:"user_name"},"Enter your username"),r.a.createElement(D.a,{type:"text",name:"user_name",id:"user_name",onChange:function(e){return t.hangleUsername(e)}})),r.a.createElement(k.a,{size:"lg",color:"primary",className:"single_search_submit",type:"submit"},"Confirm")," "," ",r.a.createElement(k.a,{size:"lg",color:"primary",className:"single_search_submit",onClick:this.send_default_username},"Default Username")," "," "))),r.a.createElement(N.a,{size:"lg",isOpen:this.state.isShowHistoryOpen,toggle:this.toggleShowHistory},r.a.createElement(I.a,{toggle:this.toggleShowHistory},"File Edit History"),r.a.createElement(x.a,null,r.a.createElement(L.a,{striped:!0,className:"history-table"},r.a.createElement("tbody",null,this.state.history.map((function(e){return r.a.createElement("tr",{key:e},r.a.createElement("td",null,e))}))))),r.a.createElement(P.a,null,r.a.createElement(k.a,{size:"lg",color:"primary",className:"single_search_submit",onClick:this.toggleShowHistory},"Close")," "," ")),r.a.createElement(N.a,{size:"lg",isOpen:this.state.isConflictModalOpen,toggle:this.toggleConflictModal},r.a.createElement(I.a,{toggle:this.toggleConflictModal},"Conflicting Incoming Changes from Other Users "),r.a.createElement(x.a,null,re),r.a.createElement(P.a,null,r.a.createElement(k.a,{size:"lg",color:"primary",className:"btn btn-primary btn-sm",onClick:this.resolve_conflict,block:!0},"Accept Incoming Changes")," "," ",r.a.createElement(k.a,{size:"lg",color:"secondary",className:"btn btn-primary btn-sm",onClick:this.toggleConflictModal,block:!0},"Ignore Incoming Changes"))),r.a.createElement(N.a,{size:"lg",isOpen:this.state.isSharedLockRejectOpen,toggle:this.toggleSharedLockReject},r.a.createElement(I.a,{toggle:this.toggleSharedLockReject},"Lock Request Rejection "),r.a.createElement(x.a,null,"Cannot place a read-only lock on a cell with an exclusive lock!"),r.a.createElement(P.a,null,r.a.createElement(k.a,{size:"lg",color:"primary",className:"btn btn-primary btn-sm",onClick:this.toggleSharedLockReject,block:!0},"Got it")," "," ")),r.a.createElement(N.a,{size:"lg",isOpen:this.state.isExclusiveLockRejectOpen,toggle:this.toggleExclusiveLockReject},r.a.createElement(I.a,{toggle:this.toggleExclusiveLockReject},"Lock Request Rejection "),r.a.createElement(x.a,null,"Cannot place an exclusive lock on a cell with a lock already!"),r.a.createElement(P.a,null,r.a.createElement(k.a,{size:"lg",color:"primary",className:"btn btn-primary btn-sm",onClick:this.toggleExclusiveLockReject,block:!0},"Got it")," "," ")))),r.a.createElement("hr",null),"Below Is The Entire Data Set",r.a.createElement("div",{id:"display_portion",onScroll:function(e){return t.track_action(e,"scroll")},tabIndex:"1"},r.a.createElement(S.a,(e={className:"handsontable",id:"display_table",data:Z,ref:this.hotTableComponent},Object(y.a)(e,"id",this.id),Object(y.a)(e,"colHeaders",!0),Object(y.a)(e,"rowHeaders",!0),Object(y.a)(e,"width","100%"),Object(y.a)(e,"height","300"),Object(y.a)(e,"colWidths","100%"),Object(y.a)(e,"rowHeights","25"),Object(y.a)(e,"contextMenu",!0),Object(y.a)(e,"formulas",!0),Object(y.a)(e,"readOnly",!this.state.transaction_mode),e))))}}]),a}(s.Component),pe=ge,fe=a(483),_e=a(135),be=new _e,Ee=[],ye=[],Se=[],ke=[],ve=[],Ce=[],Oe=!0,Re=10,Me=[],we=49,Te=0,Ne={height:2500,width:1260,border:"0.2px solid gray",margin:0,padding:0},Ie=function(e){Object(d.a)(a,e);var t=Object(m.a)(a);function a(){var e;return Object(u.a)(this,a),(e=t.call(this)).toggleRemoveAckModal=function(){e.setState({isRemoveAckModalOpen:!e.state.isRemoveAckModalOpen})},e.toggleSingleRemoveModal=function(){e.setState({isSingleRemoveModalOpen:!e.state.isSingleRemoveModalOpen})},e.toggleRangeRemoveModal=function(){e.setState({isRangeRemoveModalOpen:!e.state.isRangeRemoveModalOpen})},e.toggleErrorModal=function(){e.setState({isErrorModalOpen:!e.state.isErrorModalOpen})},e.toggleUploadAckModal=function(){e.setState({isUploadAckModalOpen:!e.state.isUploadAckModalOpen})},e.toggleSearchSelectionModal=function(){e.setState({isSearchSelectionModalOpen:!e.state.isSearchSelectionModalOpen})},e.toggleRangeSearchModal=function(){e.setState({isRangeSearchModalOpen:!e.state.isRangeSearchModalOpen,isSearchSelectionModalOpen:!e.state.isSearchSelectionModalOpen})},e.toggleSingleSearchModal=function(){e.setState({isSingelSearchModalOpen:!e.state.isSingelSearchModalOpen})},e.onRetrieveSelectionClick=function(){e.fillOutputTable(),1==e.state.isUploadAckModalOpen&&e.toggleUploadAckModal(),1==e.state.isResultPanelModalOpen&&e.toggleResultPanelModal(),1==e.state.isSingelSearchModalOpen&&e.toggleSingleSearchModal(),1==e.state.isRangeSearchModalOpen&&e.toggleRangeSearchModal()},e.toFrontPage=function(){e.setState({isResultPanelModalOpen:!1,isRangeSearchModalOpen:!1,isSingelSearchModalOpen:!1,isSearchSelectionModalOpen:!1,isUploadAckModalOpen:!1})},e.getFinalSingleSearchResult=function(t){console.log("final single search result is ",t),n=0==t.length?r.a.createElement(v.a,null,r.a.createElement("div",null,"No Entries Are Retrieved")):r.a.createElement(v.a,null,r.a.createElement("div",null,"Below Is The Retrieved Data"),r.a.createElement("div",null,r.a.createElement(U.a,{data:t}))),e.toggleResultPanelModal()},e.toggleResultPanelModal=function(){e.setState({isResultPanelModalOpen:!e.state.isResultPanelModalOpen})},e.handleSearchIndexChange=function(t){e.setState(Object(y.a)({},t.target.name,t.target.value))},e.onSingleSearchKeySubmit=function(){var t=Object(E.a)(b.a.mark((function t(a){var o,l,s;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a.preventDefault(),""==e.state.single_search_index?e.toggleErrorModal():(e.toggleSingleSearchModal(),o=!1,""===e.state.single_search_attribute&&(o=!0),l={attribute:e.state.single_search_attribute,index:e.state.single_search_index,onID:o},s={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({formResults:l})},fetch("/database/single-index-retrieval",s).then((function(e){return e.json()})).then((function(t){if(0===t.length){console.log("No data is fetched by single retrieval function");e.getFinalSingleSearchResult([])}else{var a=[];n="";for(var o=0;o<t.length;o++){for(var l=[],s=1;s<Te;s++)l[s-1]={value:t[o]["attribute"+s]};a[o]=l}e.getFinalSingleSearchResult(a)}})));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.insertSearchTable=function(){var t=Object(E.a)(b.a.mark((function t(a){var n,o,l,s,r,c;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(console.log("the single search returned data matrix is: "),console.log(a),n=[],o=0;o<a.length;o++){for(l=[],s=1;s<=Te;s++)l[s-1]=a[o]["attribute"+s];n[o]=l}return console.log("the buffer matrix is: "),console.log(n),r={matrix:n,num_attr:Te},c={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({formResults_result_buffer:r})},t.next=10,fetch("/database/insert-result-content",c);case 10:a.length>10&&(e.loadResultBuffer(Re),Re+=50),e.setState({hasMoreResult:!0,resultItems:Array.from({length:0})}),e.getFinalSingleSearchResult();case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.onRangeSearchIndexSubmit=function(t){if(t.preventDefault(),""==e.state.range_search_lower_index&&""==e.state.range_search_upper_index)e.toggleErrorModal();else{var a,o;e.toggleRangeSearchModal(),a=""==e.state.range_search_lower_index?Number.MIN_VALUE:Number(e.state.range_search_lower_index),o=""==e.state.range_search_upper_index?Number.MAX_VALUE:Number(e.state.range_search_upper_index);var l=!1;""===e.state.range_search_attribute&&(l=!0);var s={attribute:e.state.range_search_attribute,lower_index:a,upper_index:o,onID:l},r={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({formResults:s})};fetch("/database/range-index-retrieval",r).then((function(e){return e.json()})).then((function(t){if(0===t.length){console.log("No data is fetched by range retrieval function");e.getFinalSingleSearchResult([])}else{var a=[];n="";for(var o=0;o<t.length;o++){for(var l=[],s=1;s<Te;s++)l[s-1]={value:t[o]["attribute"+s]};a[o]=l}e.getFinalSingleSearchResult(a)}}))}},e.fillNewTable=function(){r.a.createElement(v.a,null,r.a.createElement(fe.a,null,"Below Is The Entire Data Set"),r.a.createElement(U.a,{data:ye})),e.toggleRemoveAckModal()},e.fileHandler=function(){var t=Object(E.a)(b.a.mark((function t(a){var n;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=a.target.files[0],console.log("file change!"),console.log("first time upload is: "+Oe),console.log(n),e.setState({hasMore:!0,load_from_buffer_to_matrix:!1,items:Array.from({length:0})}),we=49,"",Oe?Oe=!1:e.deleteDBTable(),be=new _e,t.next=11,Object(g.ExcelRenderer)(n,(function(t,a){t?console.log(t):e.setState({cols:a.cols,rows:a.rows})}));case 11:if(0===e.state.rows.length){t.next=14;break}return t.abrupt("break",16);case 14:t.next=11;break;case 16:e.toggleUploadAckModal();case 17:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.fillOutputTable=Object(E.a)(b.a.mark((function t(){var a,s,c,i,u,h,d,m,g,p,f,_,E,y,S,v,C,O;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=e.state.rows,s=e.state.cols,0==a.length&&0==s.length){t.next=43;break}for(console.log("row is: ",a),console.log("col is",s),c=0;c<s.length;c++)Ee[c]={value:s[c].name};for(console.log("the arri_array is: "),console.log(Ee),c=0;c<=s.length;c++)ke[c]=0==c?{fieldName:"id",width:(1260-s.length-1)/(s.length+1)}:{fieldName:"attr"+c,width:(1260-s.length-1)/(s.length+1)};for(console.log("the columns are: "),console.log(ke),c=0;c<50;c++)if(0==c){for(i={},u=0;u<=s.length;u++)0==u?(h={text:"id"},i.id=h):(d={text:"Attribute"+u},i["attr"+u]=d);Se[c]=i}else if(c<a.length){for(m={},u=0;u<=s.length;u++)0==u?(g={text:c},m.id=g):(p={text:a[c-1][u-1]},m["attr"+u]=p);Se[c]=m}else{for(f={},u=0;u<=s.length;u++)0==u?(_={text:""},f.id=_):(E={text:""},f["attr"+u]=E);Se[c]=f}for(console.log("the data matrix in json format is: "),console.log(Se),ye=[],n="",c=0;c<a.length;c++){for(y=[],u=0;u<s.length;u++)y[u]={value:a[c][u]};ye[c]=y}return console.log("going to test create table"),Te=s.length,S="/database/create-table/"+Number(Te),t.next=22,fetch(S);case 22:return v={matrix:a,num_attr:s.length},C={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({formResults:v})},t.next=26,fetch("/database/insert-content",C);case 26:if(!(a.length>50)){t.next=39;break}c=we;case 28:if(!(c<a.length)){t.next=37;break}if(c!==we+50){t.next=31;break}return t.abrupt("break",37);case 31:for(O={},u=0;u<=s.length;u++)0==u?O.id=c+1:O["attribute"+u]=a[c-1][u-1];ve[c-we]=O;case 34:c++,t.next=28;break;case 37:we+=50,console.log("see buffer data at this point");case 39:0==be.depth(!0)&&(l=r.a.createElement(k.a,{size:"lg",className:"range-search-button",color:"primary",onClick:e.toggleRangeSearchModal},"Range Index Retrieval"),o=r.a.createElement(k.a,{size:"lg",className:"single-search-button",color:"primary",onClick:e.toggleSingleSearchModal,type:"submit"},"Single Index Retrieval"),r.a.createElement(k.a,{color:"primary",onClick:e.toggleSingleRemoveModal},"Single Index Removal"),console.log("key type is: ",typeof a[0][0])),e.setState({isSearchSelectionModalOpen:!0}),t.next=45;break;case 43:console.log("null"),"Not uploaded yet";case 45:case"end":return t.stop()}}),t)}))),e.createDBTable=function(e){console.log("going to test create table"),fetch("/database/create-table/"+e)},e.deleteDBTable=function(e){console.log("going to test delete table"),fetch("/database/delete-table")},e.deleteResultTable=function(){console.log("going to delete result table"),fetch("/database/delete-result-table")},e.fetchMoreData=function(){if(e.state.items.length>=Math.ceil(e.state.rows.length/50))return e.setState({hasMore:!1}),void console.log("the final number of page is: "+Math.ceil(e.state.rows.length/50));if(0==e.state.load_from_buffer_to_matrix)e.setState({load_from_buffer_to_matrix:!0}),0==ve.length&&e.fetchMoreRows(50);else{for(var t=0;t<50;t++)if(t<ve.length){for(var a={},n=0;n<=Te;n++)if(0==n){var o={text:ve[t].id};a.id=o}else{var l={text:ve[t]["attribute"+n]};a["attr"+n]=l}Se[t]=a}else{console.log("i is greater than 50 now");var s={};for(n=0;n<=Te;n++)if(0==n){s.id={text:""}}else{s["attr"+n]={text:""}}Se[t]=s}e.fetchMoreRows(we),we+=50,console.log("data matrix at fetch more data is: "),console.log(Se)}setTimeout((function(){e.setState({items:e.state.items.concat(Array.from({length:1}))})}),1500)},e.fetchMoreResult=function(){if(e.state.resultItems.length>=Math.ceil(0))e.setState({hasMoreResult:!1});else{if(0==e.state.load_result_from_buffer_to_matrix)e.setState({load_result_from_buffer_to_matrix:!0});else{for(var t=0;t<10;t++)if(t<Me.length){for(var a={},n=0;n<=Te;n++)if(0==n){var o={text:Me[t].id};a.id=o}else{var l={text:Me[t]["attribute"+n]};a["attr"+n]=l}Ce[t]=a}else{var s={};for(n=0;n<=Te;n++)if(0==n){s.id={text:""}}else{s["attr"+n]={text:""}}Ce[t]=s}e.loadResultBuffer(Re),Re+=10,console.log("the new search result display matrix is: "),console.log(Ce)}setTimeout((function(){e.setState({resultItems:e.state.resultItems.concat(Array.from({length:1}))})}),500)}},e.loadResultBuffer=function(e){console.log("CALLED LOADRESULTBUFFER!"),Me=[],fetch("/database/fetch-ten-rows/"+e).then((function(e){return e.json()})).then((function(e){if(0===e.length)console.log("No data is fetched by fetchMoreResult function");else{for(var t=0;t<e.length;t++)Me[t]=e[t];console.log("the result buffer is: "),console.log(Me)}}))},e.fetchMoreRows=function(e){ve=[],fetch("/database/fetch-fifty-rows/"+e).then((function(e){return e.json()})).then((function(e){if(0===e.length)console.log("No data is fetched by fetchMoreRows function"),!0;else{!1;for(var t=0;t<e.length;t++)ve[t]=e[t];console.log("the buffer is: "),console.log(ve)}}))},e.redirect_start=function(){e.setState({redirect_to_start:!0})},e.state={rows:[],cols:[],attri:[],isSearchSelectionModalOpen:!1,isRangeSearchModalOpen:!1,isSingelSearchModalOpen:!1,isUploadAckModalOpen:!1,isErrorModalOpen:!1,single_search_index:"",single_search_attribute:"",range_search_attribute:"",isSingleSearch:!1,isResultPanelModalOpen:!1,searchResult:[],range_search_lower_index:"",range_search_upper_index:"",single_remove_index:"",range_remove_lower_index:"",range_remove_upper_index:"",isSingleRemoveModalOpen:!1,isRangeRemoveModalOpen:!1,isRemoveAckModalOpen:!1,items:Array.from({length:0}),hasMore:!1,load_from_buffer_to_matrix:!1,hasMoreResult:!1,resultItems:Array.from({length:0}),load_result_from_buffer_to_matrix:!1,redirect_to_start:!1,start_page_link:"/"},e.toggleSearchSelectionModal=e.toggleSearchSelectionModal.bind(),e.toggleRangeSearchModal=e.toggleRangeSearchModal.bind(),e.toggleSingleSearchModal=e.toggleSingleSearchModal.bind(),e.toggleUploadAckModal=e.toggleUploadAckModal.bind(),e.toggleResultPanelModal=e.toggleResultPanelModal.bind(),e.toggleErrorModal=e.toggleErrorModal.bind(),e.toggleSingleRemoveModal=e.toggleSingleRemoveModal.bind(),e.toggleRangeRemoveModal=e.toggleRangeRemoveModal.bind(),e.toggleRemoveAckModal=e.toggleRemoveAckModal.bind(),e}return Object(h.a)(a,[{key:"render",value:function(){var e=this;return this.state.redirect_to_start?r.a.createElement(f.a,{to:this.state.start_page_link}):r.a.createElement("div",{className:"App"},r.a.createElement(v.a,{className:"logo-jumbo"}),r.a.createElement("div",null,r.a.createElement(v.a,null,r.a.createElement("h1",{className:"display-3"}," Welcome to spreadsheet web!"),r.a.createElement("p",{className:"lead"},"This is a simple web interface that allows you to upload spreadsheets and retrieve data."),r.a.createElement("hr",{className:"my-2"}),r.a.createElement("p",null,"Please upload your spreadsheet below"),r.a.createElement("p",{className:"lead"},r.a.createElement("input",{type:"file",onChange:this.fileHandler.bind(this),style:{padding:"10px"}}),r.a.createElement(k.a,{size:"lg",className:"redirect-button",color:"primary",onClick:this.redirect_start},"To Start Page"),"\xa0\xa0\xa0\xa0",r.a.createElement(k.a,{size:"lg",className:"redirect-button",color:"primary",onClick:this.deleteDBTable},"Delete Table")),l,"\xa0\xa0\xa0\xa0",o,r.a.createElement(N.a,{isOpen:this.state.isUploadAckModalOpen,toggle:this.toggleUploadAckModal},r.a.createElement(I.a,{toggle:this.toggleUploadAckModal},"Upload Seccessful! "),r.a.createElement(x.a,null,r.a.createElement(k.a,{color:"primary",onClick:this.onRetrieveSelectionClick,type:"submit",block:!0},"View and Select Data Retrieval Option")," ","   ")),r.a.createElement(N.a,{isOpen:this.state.isRemoveAckModalOpen,toggle:this.toggleRemoveAckModal},r.a.createElement(I.a,{toggle:this.toggleRemoveAckModal},"Remove Seccessful! "),r.a.createElement(x.a,null,r.a.createElement(k.a,{color:"primary",onClick:this.fillNewTable,type:"submit"},"View New Content")," ","   ")),r.a.createElement(N.a,{size:"lg",isOpen:this.state.isSingelSearchModalOpen,toggle:this.toggleSingleSearchModal},r.a.createElement(I.a,{toggle:this.toggleSingleSearchModal},"Please enter your search index and search attribute "),r.a.createElement(x.a,null,r.a.createElement(j.a,{onSubmit:this.onSingleSearchKeySubmit},r.a.createElement(A.a,null,r.a.createElement(H.a,{for:"single_search_index"},"Single Search Index"),r.a.createElement(D.a,{type:"text",pattern:"[0-9]*",name:"single_search_index",id:"single_search_index",onChange:function(t){return e.handleSearchIndexChange(t)}})),r.a.createElement(A.a,null,r.a.createElement(H.a,{for:"single_search_attribute"},"Search Attribute Number (Leave blank to search on id)"),r.a.createElement(D.a,{type:"text",pattern:"[0-9]*",name:"single_search_attribute",id:"single_search_attribute",onChange:function(t){return e.handleSearchIndexChange(t)}})),r.a.createElement(k.a,{size:"lg",color:"primary",className:"single_search_submit",type:"submit"},"Search")," "," "))),r.a.createElement(N.a,{size:"lg",isOpen:this.state.isRangeSearchModalOpen,toggle:this.toggleRangeSearchModal},r.a.createElement(I.a,{toggle:this.toggleRangeSearchModal},"Please enter upper and lower search index. (First Attribute Value) "),r.a.createElement(x.a,null,r.a.createElement(j.a,{onSubmit:this.onRangeSearchIndexSubmit},r.a.createElement(A.a,null,r.a.createElement(H.a,{for:"range_search_lower_index"},"Lower Bound"),r.a.createElement(D.a,{type:"text",pattern:"[0-9]*",name:"range_search_lower_index",id:"range_search_lower_index",onChange:function(t){return e.handleSearchIndexChange(t)}})),r.a.createElement(A.a,null,r.a.createElement(H.a,{for:"range_search_upper_index"},"Upper Bound"),r.a.createElement(D.a,{type:"text",pattern:"[0-9]*",name:"range_search_upper_index",id:"range_search_upper_index",onChange:function(t){return e.handleSearchIndexChange(t)}})),r.a.createElement(A.a,null,r.a.createElement(H.a,{for:"range_search_attribute"},"Attribute Number (Leave blank to search on id)"),r.a.createElement(D.a,{type:"text",pattern:"[0-9]*",name:"range_search_attribute",id:"range_search_attribute",onChange:function(t){return e.handleSearchIndexChange(t)}})),r.a.createElement(k.a,{color:"primary",className:"range_search_submit",type:"submit",block:!0},"Search")," "," ")),r.a.createElement(P.a,null,"Hint: to find entries with indices greater/smaller than a value, only enter the lower bound/upper bound (e.g., Find entries with indices ",">"," 5, enter 5 in lower bound and leave upper bound blank).")),r.a.createElement(N.a,{isOpen:this.state.isResultPanelModalOpen,toggle:this.toggleResultPanelModal},r.a.createElement(I.a,{toggle:this.toggleResultPanelModal},"Data is retrieved. Click view to see the result"),r.a.createElement(x.a,null,r.a.createElement(k.a,{color:"primary",onClick:this.toFrontPage,type:"submit",block:!0},"View"))),r.a.createElement(N.a,{isOpen:this.state.isErrorModalOpen,toggle:this.toggleErrorModal},r.a.createElement(I.a,{toggle:this.toggleErrorModal},"There is somgthing wrong with your input. Please try again"),r.a.createElement(x.a,null,r.a.createElement(k.a,{color:"primary",onClick:this.toggleErrorModal,type:"submit",block:!0},"Try Again"))))),n,r.a.createElement("hr",null),"Below Is The Entire Data Set",r.a.createElement(G.a,{dataLength:this.state.items.length,next:this.fetchMoreData,hasMore:this.state.hasMore,loader:r.a.createElement("h4",null,"Loading..."),endMessage:r.a.createElement("p",{style:{textAlign:"center"}},r.a.createElement("b",null,"Yay! You have seen it all"))},this.state.items.map((function(e,t){return r.a.createElement("div",{style:Ne,key:t},r.a.createElement(z.ReactCanvasGrid,{cssHeight:"2499px",columns:ke,data:Se,rowHeight:49}))}))))}}]),a}(s.Component),xe=Ie,je=a(484),Ae=a(485),He=a(486),De=a(487),Le=(new(a(198)),new(a(135)),""),Pe={layout_changed:!1,changes:[]},Ue=[],ze=[],Ge=0,Fe=[],Be=[],Je=0,We=[],Ve=[],Qe=!1,Ye=!1,Ke=-1,Xe=-1,qe="",$e="",Ze=-1,et=-1,tt="",at="",nt={data:[],try_message:"SENT MESSAGE! SUCCESS!",user:""},ot="",lt=function(e){Object(d.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(u.a)(this,a),(e=t.call(this)).request_shared_lock=function(){var t={row:Ze,col:et};e.socket.emit("REQUEST_SHARED_LOCK",t)},e.request_exclusive_lock=function(t,a){var n={row:t,col:a};e.socket.emit("REQUEST_EXCLUSIVE_LOCK",n)},e.toggleNavbar=function(){e.setState({collapsed:!e.state.collapsed})},e.toggleExclusiveLockReject=function(){e.setState({isExclusiveLockRejectOpen:!e.state.isExclusiveLockRejectOpen})},e.toggleSharedLockReject=function(){e.setState({isSharedLockRejectOpen:!e.state.isSharedLockRejectOpen})},e.toggleConflictModal=function(){e.setState({isConflictModalOpen:!e.state.isConflictModalOpen})},e.toggleShowHistory=function(){e.setState({isShowHistoryOpen:!e.state.isShowHistoryOpen})},e.toggleSelectionPrompt=function(){e.setState({isSelectPromptOpen:!e.state.isSelectPromptOpen})},e.display=function(){at="",tt=e.state.transaction_mode?r.a.createElement(k.a,{size:"lg",className:"display-button",color:"primary",onClick:e.end_transaction},"End Transaction"):r.a.createElement(k.a,{size:"lg",className:"display-button",color:"primary",onClick:e.start_transaction},"Start Transaction"),e.setState({data_original:e.state.data_original.concat(Fe)}),0==We.length&&We.push(Ue),We=We.concat(Be),console.log("data display is: ",We)},e.redirect_import=function(){e.setState({redirect_import_page:!0})},e.handleScroll=function(e){e.target.scrollHeight,e.target.scrollTop,e.target.clientHeight;Je=e.target.scrollTop},e.show_state=function(){console.log(Ve),console.log(Qe)},e.sendMessage=function(t){e.socket.emit("SEND_MESSAGE",t)},e.check_cell_change=function(){if(Qe){var t="Y";e.state.transaction_mode||(t="N");var a="";a=isNaN(Ve[0][3])?"STR":"DIGIT",ze.push(["edit_cell",Ve[0][0],Ve[0][1],a,Ve[0][0]+1,Ue[Ve[0][1]],t]),nt.user=e.state.user_name;var n=[],o=parseInt(Ve[0][0])+1,l=parseInt(Ve[0][1])+1,s=Ve[0][3];n[0]=l,n[1]=s,n[2]=o,nt.data.push(n),Qe=!1}else console.log("no changed detected")},e.cell_read_only=function(t,a){e.hotTableComponent.current.hotInstance.updateSettings({cells:function(e,n,o){var l={};return e==t&&n==a&&(l.readOnly="true"),l}})},e.hangleUsername=function(t){e.setState(Object(y.a)({},t.target.name,t.target.value))},e.send_default_username=function(){e.socket.emit("SEND_USERNAME",{user_name:"anonymous user"}),e.toggleUserNamePrompt()},e.onSelectionSubmit=function(t){t.preventDefault(),console.log("call username");var a={user_name:e.state.user_name};e.socket.emit("SEND_USERNAME",a),e.toggleUserNamePrompt()},e.resolve_conflict=function(t){t.preventDefault(),We[Ke][Xe]=qe,e.state.data_original[Ke][Xe]=qe,Ke=-1,Xe=-1,qe=-1,$e="",e.toggleConflictModal()},e.start_transaction=function(){nt.data=[],e.setState({transaction_mode:!0}),tt=r.a.createElement(k.a,{size:"lg",className:"display-button",color:"primary",onClick:e.end_transaction},"End Transaction")},e.end_transaction=function(){e.setState({transaction_mode:!1}),tt=r.a.createElement(k.a,{size:"lg",className:"display-button",color:"primary",onClick:e.start_transaction},"Start Transaction")},e.track_action=function(t,a){var n="Y";e.state.transaction_mode||(n="N");var o=Date.now()/1e3-Ge;if(Ge=Date.now()/1e3,o>3)if(ze.length>0&&"idle"==ze[ze.length-1][0]){var l=ze[ze.length-1][1];ze.pop(),ze.push(["idle",parseInt(o)+l,null,null,null,null,n])}else ze.push(["idle",parseInt(o),null,null,null,null,n]);if(Pe.layout_changed){ze.length>0&&"idle"==ze[ze.length-1][0]&&ze.pop();for(var s=0;s<Pe.changes.length;s++){var r=Pe.changes[s][0],c=Pe.changes[s][1],i=Pe.changes[s][2];ze.push([r,i,c,null,null,null,n])}Pe.changes.length=0,Pe.layout_changed=!1}if("scroll"==a){var u=Je-t.target.scrollTop,h=ze.length;if(u>0)if(h>=1&&"up_scroll_l"===ze[h-1][0]);else if(h>=5){var d=!0;for(s=0;s<5;s++)if("up_scroll_s"!==ze[h-1-s][0]){d=!1;break}if(d){for(s=0;s<5;s++)ze.pop();ze.push(["up_scroll_l",null,null,null,null,null,n])}else ze.push(["up_scroll_s",null,null,null,null,null,n])}else ze.push(["up_scroll_s",null,null,null,null,null,n]);else if(u<0)if(h>=1&&"down_scroll_l"===ze[h-1][0]);else if(h>=5){var m=!0;for(s=0;s<5;s++)if("down_scroll_s"!==ze[h-1-s][0]){m=!1;break}if(m){for(s=0;s<5;s++)ze.pop();ze.push(["down_scroll_l",null,null,null,null,null,n])}else ze.push(["down_scroll_s",null,null,null,null,null,n])}else ze.push(["down_scroll_s",null,null,null,null,null,n]);e.handleScroll(t)}else"click"==a?(Ye&&(et<0?ze.push(["select_r",Ze,null,null,null,null,n]):Ze<0?ze.push(["select_c",et,null,null,null,null,n]):ze.push([a,Ze,et,null,Ze+1,Ue[et],n]),Ye=!1),e.check_cell_change()):"key_press"==a&&(Qe&&("Enter"==t.key?ze.push(["keyPress_enter",Ve[0][0],Ve[0][1],null,Ve[0][0]+1,Ue[Ve[0][1]],n]):"Tab"==t.key?ze.push(["keyPress_tab",Ve[0][0],Ve[0][1],null,Ve[0][0]+1,Ue[Ve[0][1]],n]):ze.push(["keyPress",Ve[0][0],Ve[0][1],null,Ve[0][0]+1,Ue[Ve[0][1]],n])),e.check_cell_change());console.log(ze)},e.store_training_data=function(){ze.push(["END_TRAINING_DATA",null,null,null,null,null,"END"]);var e={user_actions:ze},t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action_package:e})};fetch("/training/send-training-data/"+Le,t)},e.select_simulation=function(t){t.preventDefault(),"academic"==(Le=t.target.name)&&e.setState({redirect_academic_page:!0}),"management"==Le&&e.setState({redirect_management_page:!0}),"financing"==Le&&e.setState({redirect_financing_page:!0})},e.id="hot",e.hotTableComponent=r.a.createRef(),e.state={collapsed:!1,rows:[],cols:[],attri:[],items:Array.from({length:0}),hasMore:!1,load_from_buffer_to_matrix:!1,hasMoreResult:!1,resultItems:Array.from({length:0}),load_result_from_buffer_to_matrix:!1,redirect_import_page:!1,import_page_link:"/result",redirect_academic_page:!1,academic_page_link:"/academic",redirect_management_page:!1,management_page_link:"/management",redirect_financing_page:!1,financing_page_link:"/financing",data_original:[],check_cell_update:!1,test_block:"ORIGINAL MESSAGE",users:[],user_text_block:"",isSelectPromptOpen:!0,user_name:"",edit_message:"Last Edit: No modification yet",history:[],isShowHistoryOpen:!1,isConflictModalOpen:!1,transaction_mode:!1,isSharedLockRejectOpen:!1,isExclusiveLockRejectOpen:!1},e.socket=B()("localhost:3001"),e.socket.on("RECEIVE_MESSAGE",(function(e){p(e)})),e.socket.on("RECEIVE_ID",(function(e){l(e)})),e.socket.on("REQUEST_SHARED_REJECT",(function(e){d(e)})),e.socket.on("REQUEST_SHARED_ACCEPT",(function(e){var t=e.row,a=e.col;i(t,a)})),e.socket.on("REQUEST_EXCLUSIVE_REJECT",(function(e){var t=e.row,a=e.col;m(t,a)})),e.socket.on("REQUEST_EXCLUSIVE_ACCEPT",(function(e){var t=e.row,a=e.col;e.id!==ot&&h(t,a)})),e.socket.on("CHANGE_CURRENT_USER",(function(e){g(e)})),e.socket.on("ADD_NEW_USER",(function(e){s(e)})),e.socket.on("RECEIVE_FREED_CELLS",(function(e){o(e)})),e.socket.on("UPDATE_EDIT_MESSAGE",(function(e){n(e)}));var n=function(t){e.setState({edit_message:t.new_message,history:t.history})},o=function(t){var a=t.free_cells,n=t.disconnect;console.log("the free cells are ",a);for(var o=0;o<a.length;o++){var l=a[o];if(l[0]<We.length){var s=e.hotTableComponent.current.hotInstance.getDataAtCell(l[0],l[1]);if("*"==s[0]){var r=s.substring(1);e.hotTableComponent.current.hotInstance.setDataAtCell(l[0],l[1],r)}"-----"==s&&1==n&&(We[(l[0],l[1])]=e.state.data_original[(l[0],l[1])])}}c()},l=function(e){ot=e},s=function(t){e.setState({history:t.history}),g(t.current_users)},c=function(){console.log("setting to read only..."),e.hotTableComponent.current.hotInstance.updateSettings({cells:function(e,t,a){var n={};return console.log("undefined is: ",We[e][t]," ",e," ",t),null===We[e][t]||0===We[e][t].length||"-----"!=We[e][t]&&"*"!==We[e][t].charAt(0)||(n.readOnly="true"),n}})},i=function(t,a){if(t<We.length){var n=e.hotTableComponent.current.hotInstance.getDataAtCell(t,a);if("*"===n.charAt(0))return;var o="*"+n;e.hotTableComponent.current.hotInstance.setDataAtCell(t,a,o),c()}},h=function(t,a){if(t<We.length){console.log(t),console.log(a);e.hotTableComponent.current.hotInstance.setDataAtCell(t,a,"-----"),c()}},d=function(t){e.setState({isSharedLockRejectOpen:!e.state.isSharedLockRejectOpen})},m=function(t){e.setState({isExclusiveLockRejectOpen:!e.state.isExclusiveLockRejectOpen})},g=function(t){e.setState({users:t});for(var a="Currently Online: ",n=0;n<e.state.users.length;n++)n==e.state.users.length-1?a+=e.state.users[n]:a+=e.state.users[n]+", ";e.setState({user_text_block:a})},p=function(t){for(var a=t.data,n=0;n<a.length;n++){var o=a[n][0]-1,l=a[n][1],s=a[n][2]-1;s<We.length?(We[s][o]=l,e.state.data_original[s][o]=l):s+1<1&&(s++,Be[s+50-1][o]!=l&&(Be[s+50-1][o]=l,Fe[s+50-1][o]=l))}console.log("after socket, buffer_copy is: ",Be),e.setState({test_block:t.try_message})};return e.toggleSelectionPrompt=e.toggleSelectionPrompt.bind(),e.toggleShowHistory=e.toggleShowHistory.bind(),e.toggleConflictModal=e.toggleConflictModal.bind(),e.toggleNavbar=e.toggleNavbar.bind(),e.toggleSharedLockReject=e.toggleSharedLockReject.bind(),e.toggleExclusiveLockReject=e.toggleExclusiveLockReject.bind(),e}return Object(h.a)(a,[{key:"componentDidMount",value:function(){var e=Object(E.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Ge=Date.now()/1e3,at=r.a.createElement(k.a,{size:"lg",className:"display-button",color:"primary",onClick:this.display},"Display Dataset"),this.hotTableComponent.current.hotInstance.addHook("afterChange",(function(e,t){"edit"===t&&(console.log(e),e[0][2]!==e[0][3]&&"*"!==e[0][3].charAt(0)&&"-----"!==e[0][3]&&(console.log("differ!"),Ve=e,Qe=!0,-1,-1,Ye=!1))})),this.hotTableComponent.current.hotInstance.addHook("afterBeginEditing",(function(e,t){e,t})),this.hotTableComponent.current.hotInstance.addHook("afterSelection",(function(e,t,a,n,o,l){Ze=e,et=t,Ye=!0})),this.hotTableComponent.current.hotInstance.addHook("afterCreateRow",(function(e,t,a){console.log("insert index is: ",e),"ContextMenu.rowBelow"==a?(Pe.layout_changed=!0,Pe.changes.push(["insert_r","below",e])):(Pe.layout_changed=!0,Pe.changes.push(["insert_r","above",e]))})),this.hotTableComponent.current.hotInstance.addHook("afterCreateCol",(function(e,t,a){console.log("insert index is: ",e),"ContextMenu.columnRight"==a?(Pe.layout_changed=!0,Pe.changes.push(["insert_c","right",e])):(Pe.layout_changed=!0,Pe.changes.push(["insert_c","left",e]))})),this.hotTableComponent.current.hotInstance.addHook("afterRemoveRow",(function(e,t,a,n){Pe.layout_changed=!0,Pe.changes.push(["remove_r",null,e])})),this.hotTableComponent.current.hotInstance.addHook("afterRemoveCol",(function(e,t,a,n){Pe.layout_changed=!0,Pe.changes.push(["remove_c",null,e])}));case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){this.socket.disconnect()}},{key:"render",value:function(){var e,t=this;return this.state.redirect_import_page?r.a.createElement(f.a,{to:this.state.import_page_link}):this.state.redirect_academic_page?r.a.createElement(f.a,{to:this.state.academic_page_link}):this.state.redirect_management_page?r.a.createElement(f.a,{to:this.state.management_page_link}):this.state.redirect_financing_page?r.a.createElement(f.a,{to:this.state.financing_page_link}):r.a.createElement("div",{onClick:function(e){return t.track_action(e,"click")},onKeyUp:function(e){return t.track_action(e,"key_press")},className:"App"},r.a.createElement("script",{src:"node_modules/handsontable/dist/handsontable.full.min.js"}),r.a.createElement("link",{href:"node_modules/handsontable/dist/handsontable.full.min.css",rel:"stylesheet",media:"screen"}),r.a.createElement(v.a,{className:"logo-jumbo"}),r.a.createElement("div",null,r.a.createElement(v.a,null,r.a.createElement(C.a,{color:"faded",light:!0},r.a.createElement(O.a,{onClick:this.toggleNavbar,className:"mr-2"}),r.a.createElement(R.a,{isOpen:this.state.collapsed,navbar:!0},r.a.createElement(M.a,{tabs:!0},r.a.createElement(w.a,null,r.a.createElement(T.a,{href:"/result"},"Import Page"))))),r.a.createElement("h1",{className:"display-3"},"Hi ",this.state.user_name,", welcome to spreadsheet web!"),r.a.createElement("p",{className:"lead"},"This is a simple web interface that allows you to upload spreadsheets and retrieve data."),r.a.createElement("hr",{className:"my-2"}),r.a.createElement("p",null,this.state.user_text_block),r.a.createElement("p",{className:"lead"},r.a.createElement(k.a,{size:"lg",className:"display-button",color:"info",onClick:this.toggleShowHistory},"Edit History"),"\xa0\xa0\xa0\xa0",at,"\xa0\xa0\xa0\xa0",tt,"\xa0\xa0\xa0\xa0","","\xa0\xa0\xa0\xa0",r.a.createElement(k.a,{size:"lg",className:"display-button",color:"info",onClick:this.store_training_data},"Complete Simulation")),r.a.createElement("p",null,this.state.edit_message),r.a.createElement(N.a,{size:"lg",isOpen:this.state.isSelectPromptOpen},r.a.createElement(I.a,null,"Please Choose Your Assigned Simulation "),r.a.createElement(x.a,null,r.a.createElement(fe.a,null,r.a.createElement(je.a,{sm:"6"},r.a.createElement(Ae.a,{body:!0},r.a.createElement(He.a,{tag:"h5"},"Academic Simulation"),r.a.createElement(De.a,null,"Simulation on a university class environment"),r.a.createElement(k.a,{color:"primary",name:"academic",id:"academic",onClick:function(e){return t.select_simulation(e)}}," Choose This Simulation"))),r.a.createElement(je.a,{sm:"6"},r.a.createElement(Ae.a,{body:!0},r.a.createElement(He.a,{tag:"h5"},"Management Simulation"),r.a.createElement(De.a,null,"Simulation on management of employee schedules and project progress"),r.a.createElement(k.a,{color:"info",name:"management",id:"management",onClick:function(e){return t.select_simulation(e)}},"Choose This Simulation")))),r.a.createElement(fe.a,null,r.a.createElement(je.a,{sm:"6"},r.a.createElement(Ae.a,{body:!0},r.a.createElement(He.a,{tag:"h5"},"Financing Simulation"),r.a.createElement(De.a,null,"Simulation family or company financing, involving expenses and incomes"),r.a.createElement(k.a,{color:"primary",name:"financing",id:"financing",onClick:function(e){return t.select_simulation(e)}},"Choose This Simulation")))))),r.a.createElement(N.a,{size:"lg",isOpen:this.state.isShowHistoryOpen,toggle:this.toggleShowHistory},r.a.createElement(I.a,{toggle:this.toggleShowHistory},"File Edit History"),r.a.createElement(x.a,null,r.a.createElement(L.a,{striped:!0,className:"history-table"},r.a.createElement("tbody",null,this.state.history.map((function(e){return r.a.createElement("tr",{key:e},r.a.createElement("td",null,e))}))))),r.a.createElement(P.a,null,r.a.createElement(k.a,{size:"lg",color:"primary",className:"single_search_submit",onClick:this.toggleShowHistory},"Close")," "," ")),r.a.createElement(N.a,{size:"lg",isOpen:this.state.isConflictModalOpen,toggle:this.toggleConflictModal},r.a.createElement(I.a,{toggle:this.toggleConflictModal},"Conflicting Incoming Changes from Other Users "),r.a.createElement(x.a,null,$e),r.a.createElement(P.a,null,r.a.createElement(k.a,{size:"lg",color:"primary",className:"btn btn-primary btn-sm",onClick:this.resolve_conflict,block:!0},"Accept Incoming Changes")," "," ",r.a.createElement(k.a,{size:"lg",color:"secondary",className:"btn btn-primary btn-sm",onClick:this.toggleConflictModal,block:!0},"Ignore Incoming Changes"))),r.a.createElement(N.a,{size:"lg",isOpen:this.state.isSharedLockRejectOpen,toggle:this.toggleSharedLockReject},r.a.createElement(I.a,{toggle:this.toggleSharedLockReject},"Lock Request Rejection "),r.a.createElement(x.a,null,"Cannot place a read-only lock on a cell with an exclusive lock!"),r.a.createElement(P.a,null,r.a.createElement(k.a,{size:"lg",color:"primary",className:"btn btn-primary btn-sm",onClick:this.toggleSharedLockReject,block:!0},"Got it")," "," ")),r.a.createElement(N.a,{size:"lg",isOpen:this.state.isExclusiveLockRejectOpen,toggle:this.toggleExclusiveLockReject},r.a.createElement(I.a,{toggle:this.toggleExclusiveLockReject},"Lock Request Rejection "),r.a.createElement(x.a,null,"Cannot place an exclusive lock on a cell with a lock already!"),r.a.createElement(P.a,null,r.a.createElement(k.a,{size:"lg",color:"primary",className:"btn btn-primary btn-sm",onClick:this.toggleExclusiveLockReject,block:!0},"Got it")," "," ")))),r.a.createElement("hr",null),"Below Is The Entire Data Set",r.a.createElement("div",{id:"display_portion",onScroll:function(e){return t.track_action(e,"scroll")},tabIndex:"1"},r.a.createElement(S.a,(e={className:"handsontable",id:"display_table",data:We,ref:this.hotTableComponent},Object(y.a)(e,"id",this.id),Object(y.a)(e,"colHeaders",!0),Object(y.a)(e,"rowHeaders",!0),Object(y.a)(e,"width","100%"),Object(y.a)(e,"height","300"),Object(y.a)(e,"colWidths","100%"),Object(y.a)(e,"rowHeights","25"),Object(y.a)(e,"contextMenu",!0),Object(y.a)(e,"formulas",!0),Object(y.a)(e,"readOnly",!this.state.transaction_mode),e))))}}]),a}(s.Component),st=a(492),rt=a(493),ct=a(494),it=a(488),ut=a(489),ht=a(490),dt=a(23),mt=a.n(dt),gt=new(a(198)),pt=[],ft=[],_t=[],bt=(new(a(135)),{layout_changed:!1,changes:[]}),Et=[],yt=[],St=[],kt=[],vt=!1,Ct=[],Ot=0,Rt=[],Mt=[],wt=0,Tt=[],Nt=[],It=!1,xt=!1,jt=-1,At=-1,Ht="",Dt=-1,Lt=-1,Pt="",Ut={data:[],try_message:"SENT MESSAGE! SUCCESS!",user:""},zt="",Gt=function(e){Object(d.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(u.a)(this,a),(e=t.call(this)).toggleRestartModal=function(){e.setState({isRestartModalOpen:!e.state.isRestartModalOpen})},e.toggleNameModal=function(){e.setState({isNameModalOpen:!e.state.isNameModalOpen})},e.toggleRedirectConfirmModal=function(){e.setState({isRedirectConfirmOpen:!e.state.isRedirectConfirmOpen})},e.toggleNavbar=function(){e.setState({collapsed:!e.state.collapsed})},e.toggleExclusiveLockReject=function(){e.setState({isExclusiveLockRejectOpen:!e.state.isExclusiveLockRejectOpen})},e.toggleShowHistory=function(){e.setState({isShowHistoryOpen:!e.state.isShowHistoryOpen})},e.toggleSelectionPrompt=function(){e.setState({isSelectPromptOpen:!e.state.isSelectPromptOpen})},e.toggleInstructionModal=function(){e.setState({isInstructionOpen:!e.state.isInstructionOpen})},e.display=function(){"",Pt=e.state.transaction_mode?r.a.createElement(k.a,{size:"lg",className:"display-button",color:"primary",onClick:e.end_transaction},"End Transaction"):r.a.createElement(k.a,{size:"lg",className:"display-button",color:"primary",onClick:e.start_transaction},"Start Transaction"),e.setState({data_original:e.state.data_original.concat(Rt)}),0==Tt.length&&Tt.push(Et),Tt=Tt.concat(Mt),console.log("data display is: ",Tt)},e.redirect_import=function(){e.setState({redirect_import_page:!0})},e.handleScroll=function(e){e.target.scrollHeight,e.target.scrollTop,e.target.clientHeight;wt=e.target.scrollTop},e.show_state=function(){console.log(Nt),console.log(It)},e.sendMessage=function(t){e.socket.emit("SEND_MESSAGE",t)},e.check_cell_change=function(){if(It){var t="Y";e.state.transaction_mode||(t="N");var a="";a=isNaN(Nt[0][3])?"STR":"DIGIT",Ct.push([e.state.name,"edit_cell",Nt[0][0],Nt[0][1],a,e.state.curr_table,Nt[0][0]+1,Et[Nt[0][1]],t]),Ut.user=e.state.user_name;var n=[],o=parseInt(Nt[0][0])+1,l=parseInt(Nt[0][1])+1,s=Nt[0][3];n[0]=l,n[1]=s,n[2]=o,Ut.data.push(n),It=!1}else console.log("no changed detected")},e.cell_read_only=function(t,a){e.hotTableComponent.current.hotInstance.updateSettings({cells:function(e,n,o){var l={};return e==t&&n==a&&(l.readOnly="true"),l}})},e.hangleUsername=function(t){e.setState(Object(y.a)({},t.target.name,t.target.value))},e.send_default_username=function(){e.socket.emit("SEND_USERNAME",{user_name:"anonymous user"}),e.toggleUserNamePrompt()},e.onSelectionSubmit=function(t){t.preventDefault(),console.log("call username");var a={user_name:e.state.user_name};e.socket.emit("SEND_USERNAME",a),e.toggleUserNamePrompt()},e.resolve_conflict=function(t){t.preventDefault(),Tt[jt][At]=Ht,e.state.data_original[jt][At]=Ht,jt=-1,At=-1,Ht=-1,"",e.toggleConflictModal()},e.start_transaction=function(){Ut.data=[],e.setState({transaction_mode:!0}),Pt=r.a.createElement(k.a,{size:"lg",className:"display-button",color:"primary",onClick:e.end_transaction},"End Transaction")},e.end_transaction=function(){e.setState({transaction_mode:!1}),Pt=r.a.createElement(k.a,{size:"lg",className:"display-button",color:"primary",onClick:e.start_transaction},"Start Transaction")},e.track_action=function(t,a){var n="Y";e.state.transaction_mode||(n="N");var o=Date.now()/1e3-Ot;if(Ot=Date.now()/1e3,o>3)if(Ct.length>0&&"idle"==Ct[Ct.length-1][1]){var l=Ct[Ct.length-1][2];Ct.pop(),Ct.push([e.state.name,"idle",parseInt(o)+l,null,null,e.state.curr_table,null,null,n])}else Ct.push([e.state.name,"idle",parseInt(o),null,null,e.state.curr_table,null,null,n]);if(bt.layout_changed){Ct.length>0&&"idle"==Ct[Ct.length-1][1]&&Ct.pop();for(var s=0;s<bt.changes.length;s++){var r=bt.changes[s][0],c=bt.changes[s][1],i=bt.changes[s][2];Ct.push([e.state.name,r,i,c,null,e.state.curr_table,null,null,n])}bt.changes.length=0,bt.layout_changed=!1}if("scroll"==a){var u=wt-t.target.scrollTop,h=Ct.length;if(u>0)if(h>=1&&"up_scroll_l"===Ct[h-1][1]);else if(h>=5){var d=!0;for(s=0;s<5;s++)if("up_scroll_s"!==Ct[h-1-s][1]){d=!1;break}if(d){for(s=0;s<5;s++)Ct.pop();Ct.push([e.state.name,"up_scroll_l",null,null,null,e.state.curr_table,null,null,n])}else Ct.push([e.state.name,"up_scroll_s",null,null,null,e.state.curr_table,null,null,n])}else Ct.push([e.state.name,"up_scroll_s",null,null,null,e.state.curr_table,null,null,n]);else if(u<0)if(h>=1&&"down_scroll_l"===Ct[h-1][1]);else if(h>=5){var m=!0;for(s=0;s<5;s++)if("down_scroll_s"!==Ct[h-1-s][1]){m=!1;break}if(m){for(s=0;s<5;s++)Ct.pop();Ct.push([e.state.name,"down_scroll_l",null,null,null,e.state.curr_table,null,null,n])}else Ct.push([e.state.name,"down_scroll_s",null,null,null,e.state.curr_table,null,null,n])}else Ct.push([e.state.name,"down_scroll_s",null,null,null,e.state.curr_table,null,null,n]);e.handleScroll(t)}else"click"==a?(xt&&(Lt<0?Ct.push([e.state.name,"select_r",Dt,null,null,e.state.curr_table,null,null,n]):Dt<0?Ct.push([e.state.name,"select_c",Lt,null,null,e.state.curr_table,null,null,n]):Ct.push([e.state.name,a,Dt,Lt,null,e.state.curr_table,Dt+1,Et[Lt],n]),xt=!1),e.check_cell_change()):"key_press"==a&&(It&&("Enter"==t.key?Ct.push([e.state.name,"keyPress_enter",Nt[0][0],Nt[0][1],null,e.state.curr_table,Nt[0][0]+1,Et[Nt[0][1]],n]):"Tab"==t.key?Ct.push([e.state.name,"keyPress_tab",Nt[0][0],Nt[0][1],null,e.state.curr_table,Nt[0][0]+1,Et[Nt[0][1]],n]):Ct.push([e.state.name,"keyPress",Nt[0][0],Nt[0][1],null,e.state.curr_table,Nt[0][0]+1,Et[Nt[0][1]],n])),e.check_cell_change());console.log(Ct)},e.store_training_data=function(){Ct.push([e.state.name,"END_TRAINING_DATA",null,null,null,e.state.curr_table,null,null,"END"]);var t={user_actions:Ct},a={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action_package:t})};fetch("/training/send-training-data/academic",a)},e.select_simulation=function(t){console.log("called this function with: ",t.target.name),"academic"==t.target.name&&e.setState({redirect_link:"/academic"}),"financing"==t.target.name&&e.setState({redirect_link:"/financing"}),"management"==t.target.name&&e.setState({redirect_link:"/management"}),e.toggleRedirectConfirmModal()},e.toggle=function(t){e.state.activeTab!==t&&e.setState({activeTab:t}),"1"===t?(e.setState({curr_table:"attendance"}),Et=yt):"2"===t?(e.setState({curr_table:"cs225_gradebook"}),Et=St):"3"===t&&(e.setState({curr_table:"student_status"}),Et=kt)},e.load_tables=function(t){t.preventDefault(),vt?e.toggleInstructionModal():(vt=!0,gt.load_simulation_v2(1,"attendance",pt,Mt,yt),gt.load_simulation_v2(1,"grade_book",ft,Mt,St),gt.load_simulation_v2(1,"student_status",_t,Mt,kt),setTimeout((function(){pt=[yt].concat(pt),ft=[St].concat(ft),_t=[kt].concat(_t),e.setState({isInstructionOpen:!1})}),500),Et=yt,e.setState({isNameModalOpen:!1}))},e.reload_tables=function(){vt=!0,gt.load_simulation_v2(1,"attendance",pt,Mt,yt),gt.load_simulation_v2(1,"grade_book",ft,Mt,St),gt.load_simulation_v2(1,"student_status",_t,Mt,kt),setTimeout((function(){pt=[yt].concat(pt),ft=[St].concat(ft),_t=[kt].concat(_t)}),500),Et=yt},e.redirect=function(t){t.preventDefault(),e.setState({redirect:!0})},e.onNameSubmit=function(t){e.setState(Object(y.a)({},t.target.name,t.target.value))},e.submitName=function(t){t.preventDefault(),console.log("state name is: ",e.state.name),e.toggleNameModal()},e.restart=function(){pt=[],ft=[],_t=[],yt=[],St=[],kt=[],e.reload_tables(),Ct=[],e.setState({activeTab:"1"}),e.toggle("1"),e.toggleRestartModal()},e.id="hot",e.hotTableComponent=r.a.createRef(),e.hotTableComponent1=r.a.createRef(),e.hotTableComponent2=r.a.createRef(),e.state={collapsed:!1,items:Array.from({length:0}),hasMore:!1,load_from_buffer_to_matrix:!1,hasMoreResult:!1,resultItems:Array.from({length:0}),load_result_from_buffer_to_matrix:!1,redirect_import_page:!1,import_page_link:"/result",data_original:[],check_cell_update:!1,test_block:"ORIGINAL MESSAGE",users:[],user_text_block:"",isSelectPromptOpen:!0,user_name:"",edit_message:"Last Edit: No modification yet",history:[],isShowHistoryOpen:!1,transaction_mode:!1,isSharedLockRejectOpen:!1,isExclusiveLockRejectOpen:!1,isInstructionOpen:!0,activeTab:"1",redirect_link:"",isRedirectConfirmOpen:!1,redirect:!1,isNameModalOpen:!1,name:"",curr_table:"attendance",isRestartModalOpen:!1},e.socket=B()("localhost:3001"),e.socket.on("RECEIVE_MESSAGE",(function(e){g(e)})),e.socket.on("RECEIVE_ID",(function(e){o(e)})),e.socket.on("REQUEST_SHARED_REJECT",(function(e){h(e)})),e.socket.on("REQUEST_SHARED_ACCEPT",(function(e){var t=e.row,a=e.col;c(t,a)})),e.socket.on("REQUEST_EXCLUSIVE_REJECT",(function(e){var t=e.row,a=e.col;d(t,a)})),e.socket.on("REQUEST_EXCLUSIVE_ACCEPT",(function(e){var t=e.row,a=e.col;e.id!==zt&&i(t,a)})),e.socket.on("CHANGE_CURRENT_USER",(function(e){m(e)})),e.socket.on("ADD_NEW_USER",(function(e){l(e)})),e.socket.on("UPDATE_EDIT_MESSAGE",(function(e){n(e)}));var n=function(t){e.setState({edit_message:t.new_message,history:t.history})},o=function(e){zt=e},l=function(t){e.setState({history:t.history}),m(t.current_users)},s=function(){console.log("setting to read only..."),e.hotTableComponent.current.hotInstance.updateSettings({cells:function(e,t,a){var n={};return console.log("undefined is: ",Tt[e][t]," ",e," ",t),null===Tt[e][t]||0===Tt[e][t].length||"-----"!=Tt[e][t]&&"*"!==Tt[e][t].charAt(0)||(n.readOnly="true"),n}})},c=function(t,a){if(t<Tt.length){var n=e.hotTableComponent.current.hotInstance.getDataAtCell(t,a);if("*"===n.charAt(0))return;var o="*"+n;e.hotTableComponent.current.hotInstance.setDataAtCell(t,a,o),s()}},i=function(t,a){if(t<Tt.length){console.log(t),console.log(a);e.hotTableComponent.current.hotInstance.setDataAtCell(t,a,"-----"),s()}},h=function(t){e.setState({isSharedLockRejectOpen:!e.state.isSharedLockRejectOpen})},d=function(t){e.setState({isExclusiveLockRejectOpen:!e.state.isExclusiveLockRejectOpen})},m=function(t){e.setState({users:t});for(var a="Currently Online: ",n=0;n<e.state.users.length;n++)n==e.state.users.length-1?a+=e.state.users[n]:a+=e.state.users[n]+", ";e.setState({user_text_block:a})},g=function(t){for(var a=t.data,n=0;n<a.length;n++){var o=a[n][0]-1,l=a[n][1],s=a[n][2]-1;s<Tt.length?(Tt[s][o]=l,e.state.data_original[s][o]=l):s+1<1&&(s++,Mt[s+50-1][o]!=l&&(Mt[s+50-1][o]=l,Rt[s+50-1][o]=l))}console.log("after socket, buffer_copy is: ",Mt),e.setState({test_block:t.try_message})};return e.toggleSelectionPrompt=e.toggleSelectionPrompt.bind(),e.toggleShowHistory=e.toggleShowHistory.bind(),e.toggleNavbar=e.toggleNavbar.bind(),e.toggleExclusiveLockReject=e.toggleExclusiveLockReject.bind(),e.toggleInstructionModal=e.toggleInstructionModal.bind(),e.toggleRedirectConfirmModal=e.toggleRedirectConfirmModal.bind(),e.toggleNameModal=e.toggleNameModal.bind(),e.toggleRestartModal=e.toggleRestartModal.bind(),e}return Object(h.a)(a,[{key:"componentDidMount",value:function(){var e=Object(E.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Ot=Date.now()/1e3,Pt=r.a.createElement(k.a,{size:"lg",className:"display-button",color:"primary",onClick:this.start_transaction},"Start Transaction"),this.hotTableComponent.current.hotInstance.addHook("afterChange",(function(e,t){"edit"===t&&(console.log(e),e[0][2]!==e[0][3]&&"*"!==e[0][3].charAt(0)&&"-----"!==e[0][3]&&(console.log("differ!"),Nt=e,It=!0,-1,-1,xt=!1))})),this.hotTableComponent.current.hotInstance.addHook("afterBeginEditing",(function(e,t){e,t})),this.hotTableComponent.current.hotInstance.addHook("afterSelection",(function(e,t,a,n,o,l){Dt=e,Lt=t,xt=!0})),this.hotTableComponent.current.hotInstance.addHook("afterCreateRow",(function(e,t,a){console.log("insert index is: ",e),"ContextMenu.rowBelow"==a?(bt.layout_changed=!0,bt.changes.push(["insert_r","below",e])):(bt.layout_changed=!0,bt.changes.push(["insert_r","above",e]))})),this.hotTableComponent.current.hotInstance.addHook("afterCreateCol",(function(e,t,a){console.log("insert index is: ",e),"ContextMenu.columnRight"==a?(bt.layout_changed=!0,bt.changes.push(["insert_c","right",e])):(bt.layout_changed=!0,bt.changes.push(["insert_c","left",e]))})),this.hotTableComponent.current.hotInstance.addHook("afterRemoveRow",(function(e,t,a,n){bt.layout_changed=!0,bt.changes.push(["remove_r",null,e])})),this.hotTableComponent.current.hotInstance.addHook("afterRemoveCol",(function(e,t,a,n){bt.layout_changed=!0,bt.changes.push(["remove_c",null,e])})),this.hotTableComponent1.current.hotInstance.addHook("afterChange",(function(e,t){"edit"===t&&(console.log(e),e[0][2]!==e[0][3]&&"*"!==e[0][3].charAt(0)&&"-----"!==e[0][3]&&(console.log("differ!"),Nt=e,It=!0,-1,-1,xt=!1))})),this.hotTableComponent1.current.hotInstance.addHook("afterBeginEditing",(function(e,t){e,t})),this.hotTableComponent1.current.hotInstance.addHook("afterSelection",(function(e,t,a,n,o,l){Dt=e,Lt=t,xt=!0})),this.hotTableComponent1.current.hotInstance.addHook("afterCreateRow",(function(e,t,a){console.log("insert index is: ",e),"ContextMenu.rowBelow"==a?(bt.layout_changed=!0,bt.changes.push(["insert_r","below",e])):(bt.layout_changed=!0,bt.changes.push(["insert_r","above",e]))})),this.hotTableComponent1.current.hotInstance.addHook("afterCreateCol",(function(e,t,a){console.log("insert index is: ",e),"ContextMenu.columnRight"==a?(bt.layout_changed=!0,bt.changes.push(["insert_c","right",e])):(bt.layout_changed=!0,bt.changes.push(["insert_c","left",e]))})),this.hotTableComponent1.current.hotInstance.addHook("afterRemoveRow",(function(e,t,a,n){bt.layout_changed=!0,bt.changes.push(["remove_r",null,e])})),this.hotTableComponent1.current.hotInstance.addHook("afterRemoveCol",(function(e,t,a,n){bt.layout_changed=!0,bt.changes.push(["remove_c",null,e])})),this.hotTableComponent2.current.hotInstance.addHook("afterChange",(function(e,t){"edit"===t&&(console.log(e),e[0][2]!==e[0][3]&&"*"!==e[0][3].charAt(0)&&"-----"!==e[0][3]&&(console.log("differ!"),Nt=e,It=!0,-1,-1,xt=!1))})),this.hotTableComponent2.current.hotInstance.addHook("afterBeginEditing",(function(e,t){e,t})),this.hotTableComponent2.current.hotInstance.addHook("afterSelection",(function(e,t,a,n,o,l){Dt=e,Lt=t,xt=!0})),this.hotTableComponent2.current.hotInstance.addHook("afterCreateRow",(function(e,t,a){console.log("insert index is: ",e),"ContextMenu.rowBelow"==a?(bt.layout_changed=!0,bt.changes.push(["insert_r","below",e])):(bt.layout_changed=!0,bt.changes.push(["insert_r","above",e]))})),this.hotTableComponent2.current.hotInstance.addHook("afterCreateCol",(function(e,t,a){console.log("insert index is: ",e),"ContextMenu.columnRight"==a?(bt.layout_changed=!0,bt.changes.push(["insert_c","right",e])):(bt.layout_changed=!0,bt.changes.push(["insert_c","left",e]))})),this.hotTableComponent2.current.hotInstance.addHook("afterRemoveRow",(function(e,t,a,n){bt.layout_changed=!0,bt.changes.push(["remove_r",null,e])})),this.hotTableComponent2.current.hotInstance.addHook("afterRemoveCol",(function(e,t,a,n){bt.layout_changed=!0,bt.changes.push(["remove_c",null,e])}));case 23:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){this.socket.disconnect()}},{key:"render",value:function(){var e,t,a,n=this;return this.state.redirect?r.a.createElement(f.a,{to:this.state.redirect_link}):r.a.createElement("div",{onClick:function(e){return n.track_action(e,"click")},onKeyUp:function(e){return n.track_action(e,"key_press")},className:"App"},r.a.createElement("script",{src:"node_modules/handsontable/dist/handsontable.full.min.js"}),r.a.createElement("link",{href:"node_modules/handsontable/dist/handsontable.full.min.css",rel:"stylesheet",media:"screen"}),r.a.createElement(v.a,{className:"logo-jumbo"},r.a.createElement(st.a,{isOpen:this.state.collapsed,toggle:this.toggleNavbar,style:{float:"left"},className:"up-margin-one"},r.a.createElement(rt.a,{color:"#61dafb",caret:!0,style:{float:"right"}},"Change Simulation"),r.a.createElement(ct.a,null,r.a.createElement(it.a,{name:"financing",id:"financing",onClick:function(e){return n.select_simulation(e)}},"Financing Simulation"),r.a.createElement(it.a,{divider:!0}),r.a.createElement(it.a,{name:"management",id:"management",onClick:function(e){return n.select_simulation(e)}},"Management Simulation")))),r.a.createElement("div",null,r.a.createElement(v.a,null,r.a.createElement("h1",{className:"display-3"},"Hi ",this.state.user_name,", welcome to Academic Simulation!"),r.a.createElement("p",{className:"lead"},"This is a simple web interface that allows you to upload spreadsheets and retrieve data."),r.a.createElement("hr",{className:"my-2"}),r.a.createElement("p",{className:"lead"},"\xa0\xa0\xa0\xa0",Pt,"\xa0\xa0\xa0\xa0",r.a.createElement(k.a,{size:"lg",className:"display-button",color:"info",onClick:this.store_training_data},"Complete Simulation"),"\xa0\xa0\xa0\xa0",r.a.createElement(k.a,{size:"lg",className:"display-button",color:"info",onClick:this.restart},"Restart Simulation"),"\xa0\xa0\xa0\xa0",r.a.createElement(k.a,{size:"lg",className:"display-button",color:"info",onClick:this.toggleInstructionModal},"Instruction")),r.a.createElement(N.a,{size:"lg",isOpen:this.state.isInstructionOpen},r.a.createElement(x.a,null,r.a.createElement("h2",null,"Welcome"),'Welcome to Academic Simulation! This instruction can be accessed at any time by clicking the "Instruction" button on this webpage. Under this simulation, there are three tables: attendance table, gradebook table, and a student status table. This simulation has two parts.',r.a.createElement("hr",{className:"my-2"}),r.a.createElement("p",{className:"margin-one"},r.a.createElement("h2",null,"Part 1"),'Part 1 simulates a seven-day period. For each day from Monday to Friday, you are to fill our the attendance table and then the student status table. First, you will pretend it is a Monday, and you are to fill out the attendance table for Monday on all of your students. After taking the Monday\'s attendance, you will open up the student status table, and increment the number of tardies and absents for each student based on Monday\'s attendance in the following manner: First, 3 tardies count as 1 absent. For example, a student with 4 tardies and 1 absent will be updated to have 1 tardy and 2 absent. Second, 3 absents result in a disciplinary action, so a student with 3 absent and 1 disciplinary action will be updated to 1 absent and 2 disciplinary action. Third, update the status based on how many disciplinary action the student has. If the student has 1 disciplinary action, the status will be changed to "warning"; for 2 disciplinary actions, the status will be "final warning"; for 3 disciplinary actions, the status will be "drop out". Next, you will pretend that the day is Tuesday, and you will need repeat the above procedures for this day. You need to complete the same procedures for each day from Monday to Friday.',r.a.createElement("h5",null,"Note: "),"Make sure to follow the procedures day-by-day! That is, fill out Monday attendance, and the update student status; then fill our Tuesday attendance, and then update student status; then Wednesday attendance... etc. Do not jump ahead."),r.a.createElement("hr",{className:"my-2"}),r.a.createElement("h2",null,"Part 2"),"In part 2, you need to log each students' grade into the grade book. The grades for each assignment for each individual student is included in the email we sent you. If you did not get the email, please exit the simulation and contact ninghan2@illinois.edu. Note we are simulating the course progress in chronological order, where MP1 is due, and then MP2, then MP3, then MP4, then Lab1...etc. So, when filling out the gradebook, please make sure to fill out the table assignment-by-assignment. That is. fill out all students' score for a particular assignment before moving to the next assignment. After filling out all the assignment, please calculate each students' final grade (by hand, since we don't support formula function here). The total score for the course is 1000 points, and the students' final grade is in percentage. After filling out the grade book, you will go to the student status table and update it in the following manner. For each student that has a final grade less than 60%, update that student's status to \"warning\" if the student's current status is normal. If that student's current status is not normal, don't change anything for that student."),r.a.createElement(P.a,null,r.a.createElement(k.a,{size:"lg",className:"display-button",color:"info",onClick:this.load_tables},"Got it!"))),r.a.createElement(N.a,{size:"lg",isOpen:this.state.isRedirectConfirmOpen,toggle:this.toggleRedirectConfirmModal},r.a.createElement(I.a,{toggle:this.toggleRedirectConfirmModal},"Are you sure you want to leave this page?"),r.a.createElement(x.a,null,"Note that once you leave this simulation page, you will lose all the records and progress on this simulation."),r.a.createElement(P.a,null,r.a.createElement(k.a,{size:"lg",className:"display-button",color:"info",onClick:this.redirect},"Confirm")," "," ",r.a.createElement(k.a,{size:"lg",className:"display-button",color:"info",onClick:this.toggleRedirectConfirmModal},"Cancel"))),r.a.createElement(N.a,{size:"lg",isOpen:this.state.isNameModalOpen,toggle:this.toggleNameModal},r.a.createElement(I.a,{toggle:this.toggleNameModal},"Please Enter Your Full Name"),r.a.createElement(x.a,null,r.a.createElement(j.a,{onSubmit:this.submitName},r.a.createElement(A.a,null,r.a.createElement(H.a,{for:"user_name"},"Enter Full Name"),r.a.createElement(D.a,{type:"text",name:"name",id:"name",onChange:function(e){return n.onNameSubmit(e)}})),r.a.createElement(k.a,{size:"lg",color:"primary",className:"single_search_submit",type:"submit"},"Confirm")," "," "))),r.a.createElement(N.a,{size:"lg",isOpen:this.state.isRestartModalOpen,toggle:this.toggleRestartModal},r.a.createElement(I.a,{toggle:this.toggleRestartModal},"Please Enter Your Full Name"),r.a.createElement(x.a,null,"Your simulation has been restarted. All the changes that haven't been committed yet are clearned."),r.a.createElement(P.a,null,r.a.createElement(k.a,{size:"lg",className:"display-button",color:"info",onClick:this.toggleRestartModal},"Got It"))))),r.a.createElement(M.a,{tabs:!0},r.a.createElement(w.a,null,r.a.createElement(T.a,{className:mt()({active:"1"===this.state.activeTab}),onClick:function(){n.toggle("1")}},"Attendance Table")),r.a.createElement(w.a,null,r.a.createElement(T.a,{className:mt()({active:"2"===this.state.activeTab}),onClick:function(){n.toggle("2")}},"Gradebook")),r.a.createElement(w.a,null,r.a.createElement(T.a,{className:mt()({active:"3"===this.state.activeTab}),onClick:function(){n.toggle("3")}},"Student Status"))),r.a.createElement(ut.a,{activeTab:this.state.activeTab},r.a.createElement(ht.a,{tabId:"1"},r.a.createElement("h4",null,"Attendance"),r.a.createElement("div",{id:"display_portion",onScroll:function(e){return n.track_action(e,"scroll")},tabIndex:"1"},r.a.createElement(S.a,(e={className:"handsontable",id:"display_table",data:pt,ref:this.hotTableComponent},Object(y.a)(e,"id",this.id),Object(y.a)(e,"colHeaders",!0),Object(y.a)(e,"rowHeaders",!0),Object(y.a)(e,"width","100%"),Object(y.a)(e,"height","300"),Object(y.a)(e,"colWidths","100%"),Object(y.a)(e,"rowHeights","25"),Object(y.a)(e,"contextMenu",!0),Object(y.a)(e,"formulas",!0),Object(y.a)(e,"readOnly",!this.state.transaction_mode),e)))),r.a.createElement(ht.a,{tabId:"2"},r.a.createElement("h4",null,"Gradebook"),r.a.createElement("div",{id:"display_portion",onScroll:function(e){return n.track_action(e,"scroll")},tabIndex:"1"},r.a.createElement(S.a,(t={className:"handsontable",id:"display_table",data:ft,ref:this.hotTableComponent1},Object(y.a)(t,"id",this.id),Object(y.a)(t,"colHeaders",!0),Object(y.a)(t,"rowHeaders",!0),Object(y.a)(t,"width","100%"),Object(y.a)(t,"height","300"),Object(y.a)(t,"colWidths","100%"),Object(y.a)(t,"rowHeights","25"),Object(y.a)(t,"contextMenu",!0),Object(y.a)(t,"formulas",!0),Object(y.a)(t,"readOnly",!this.state.transaction_mode),t)))),r.a.createElement(ht.a,{tabId:"3"},r.a.createElement("h4",null,"Student Status Table"),r.a.createElement("div",{id:"display_portion",onScroll:function(e){return n.track_action(e,"scroll")},tabIndex:"1"},r.a.createElement(S.a,(a={className:"handsontable",id:"display_table",data:_t,ref:this.hotTableComponent2},Object(y.a)(a,"id",this.id),Object(y.a)(a,"colHeaders",!0),Object(y.a)(a,"rowHeaders",!0),Object(y.a)(a,"width","100%"),Object(y.a)(a,"height","300"),Object(y.a)(a,"colWidths","100%"),Object(y.a)(a,"rowHeights","25"),Object(y.a)(a,"contextMenu",!0),Object(y.a)(a,"formulas",!0),Object(y.a)(a,"readOnly",!this.state.transaction_mode),a))))))}}]),a}(s.Component),Ft=new(a(198)),Bt=[],Jt=[],Wt=[],Vt=!1,Qt=(new(a(135)),{layout_changed:!1,changes:[]}),Yt=[],Kt=[],Xt=[],qt=[],$t=[],Zt=0,ea=[],ta=[],aa=0,na=[],oa=[],la=!1,sa=!1,ra=-1,ca=-1,ia="",ua=-1,ha=-1,da="",ma={data:[],try_message:"SENT MESSAGE! SUCCESS!",user:""},ga="",pa=function(e){Object(d.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(u.a)(this,a),(e=t.call(this)).request_shared_lock=function(){var t={row:ua,col:ha};e.socket.emit("REQUEST_SHARED_LOCK",t)},e.request_exclusive_lock=function(t,a){var n={row:t,col:a};e.socket.emit("REQUEST_EXCLUSIVE_LOCK",n)},e.toggleRestartModal=function(){e.setState({isRestartModalOpen:!e.state.isRestartModalOpen})},e.toggleNameModal=function(){e.setState({isNameModalOpen:!e.state.isNameModalOpen})},e.toggleRedirectConfirmModal=function(){e.setState({isRedirectConfirmOpen:!e.state.isRedirectConfirmOpen})},e.toggleNavbar=function(){e.setState({collapsed:!e.state.collapsed})},e.toggleExclusiveLockReject=function(){e.setState({isExclusiveLockRejectOpen:!e.state.isExclusiveLockRejectOpen})},e.toggleShowHistory=function(){e.setState({isShowHistoryOpen:!e.state.isShowHistoryOpen})},e.toggleSelectionPrompt=function(){e.setState({isSelectPromptOpen:!e.state.isSelectPromptOpen})},e.toggleInstructionModal=function(){e.setState({isInstructionOpen:!e.state.isInstructionOpen})},e.display=function(){"",da=e.state.transaction_mode?r.a.createElement(k.a,{size:"lg",className:"display-button",color:"primary",onClick:e.end_transaction},"End Transaction"):r.a.createElement(k.a,{size:"lg",className:"display-button",color:"primary",onClick:e.start_transaction},"Start Transaction"),e.setState({data_original:e.state.data_original.concat(ea)}),0==na.length&&na.push(Yt),na=na.concat(ta),console.log("data display is: ",na)},e.redirect_import=function(){e.setState({redirect_import_page:!0})},e.handleScroll=function(e){e.target.scrollHeight,e.target.scrollTop,e.target.clientHeight;aa=e.target.scrollTop},e.show_state=function(){console.log(oa),console.log(la)},e.sendMessage=function(t){e.socket.emit("SEND_MESSAGE",t)},e.check_cell_change=function(){if(la){var t="Y";e.state.transaction_mode||(t="N");var a="";a=isNaN(oa[0][3])?"STR":"DIGIT",$t.push([e.state.name,"edit_cell",oa[0][0],oa[0][1],a,e.state.curr_table,oa[0][0]+1,Yt[oa[0][1]],t]),ma.user=e.state.user_name;var n=[],o=parseInt(oa[0][0])+1,l=parseInt(oa[0][1])+1,s=oa[0][3];n[0]=l,n[1]=s,n[2]=o,ma.data.push(n),la=!1}else console.log("no changed detected")},e.cell_read_only=function(t,a){e.hotTableComponent.current.hotInstance.updateSettings({cells:function(e,n,o){var l={};return e==t&&n==a&&(l.readOnly="true"),l}})},e.hangleUsername=function(t){e.setState(Object(y.a)({},t.target.name,t.target.value))},e.send_default_username=function(){e.socket.emit("SEND_USERNAME",{user_name:"anonymous user"}),e.toggleUserNamePrompt()},e.onSelectionSubmit=function(t){t.preventDefault(),console.log("call username");var a={user_name:e.state.user_name};e.socket.emit("SEND_USERNAME",a),e.toggleUserNamePrompt()},e.resolve_conflict=function(t){t.preventDefault(),na[ra][ca]=ia,e.state.data_original[ra][ca]=ia,ra=-1,ca=-1,ia=-1,"",e.toggleConflictModal()},e.start_transaction=function(){ma.data=[],e.setState({transaction_mode:!0}),da=r.a.createElement(k.a,{size:"lg",className:"display-button",color:"primary",onClick:e.end_transaction},"End Transaction")},e.end_transaction=function(){e.setState({transaction_mode:!1}),da=r.a.createElement(k.a,{size:"lg",className:"display-button",color:"primary",onClick:e.start_transaction},"Start Transaction")},e.track_action=function(t,a){var n="Y";e.state.transaction_mode||(n="N");var o=Date.now()/1e3-Zt;if(Zt=Date.now()/1e3,o>3)if($t.length>0&&"idle"==$t[$t.length-1][1]){var l=$t[$t.length-1][2];$t.pop(),$t.push([e.state.name,"idle",parseInt(o)+l,null,null,e.state.curr_table,null,null,n])}else $t.push([e.state.name,"idle",parseInt(o),null,null,e.state.curr_table,null,null,n]);if(Qt.layout_changed){$t.length>0&&"idle"==$t[$t.length-1][1]&&$t.pop();for(var s=0;s<Qt.changes.length;s++){var r=Qt.changes[s][0],c=Qt.changes[s][1],i=Qt.changes[s][2];$t.push([e.state.name,r,i,c,null,e.state.curr_table,null,null,n])}Qt.changes.length=0,Qt.layout_changed=!1}if("scroll"==a){var u=aa-t.target.scrollTop,h=$t.length;if(u>0)if(h>=1&&"up_scroll_l"===$t[h-1][1]);else if(h>=5){var d=!0;for(s=0;s<5;s++)if("up_scroll_s"!==$t[h-1-s][1]){d=!1;break}if(d){for(s=0;s<5;s++)$t.pop();$t.push([e.state.name,"up_scroll_l",null,null,null,e.state.curr_table,null,null,n])}else $t.push([e.state.name,"up_scroll_s",null,null,null,e.state.curr_table,null,null,n])}else $t.push([e.state.name,"up_scroll_s",null,null,null,e.state.curr_table,null,null,n]);else if(u<0)if(h>=1&&"down_scroll_l"===$t[h-1][1]);else if(h>=5){var m=!0;for(s=0;s<5;s++)if("down_scroll_s"!==$t[h-1-s][1]){m=!1;break}if(m){for(s=0;s<5;s++)$t.pop();$t.push([e.state.name,"down_scroll_l",null,null,null,e.state.curr_table,null,null,n])}else $t.push([e.state.name,"down_scroll_s",null,null,null,e.state.curr_table,null,null,n])}else $t.push([e.state.name,"down_scroll_s",null,null,null,e.state.curr_table,null,null,n]);e.handleScroll(t)}else"click"==a?(sa&&(ha<0?$t.push([e.state.name,"select_r",ua,null,null,e.state.curr_table,null,null,n]):ua<0?$t.push([e.state.name,"select_c",ha,null,null,e.state.curr_table,null,null,n]):$t.push([e.state.name,a,ua,ha,null,e.state.curr_table,ua+1,Yt[ha],n]),sa=!1),e.check_cell_change()):"key_press"==a&&(la&&("Enter"==t.key?$t.push([e.state.name,"keyPress_enter",oa[0][0],oa[0][1],null,e.state.curr_table,oa[0][0]+1,Yt[oa[0][1]],n]):"Tab"==t.key?$t.push([e.state.name,"keyPress_tab",oa[0][0],oa[0][1],null,e.state.curr_table,oa[0][0]+1,Yt[oa[0][1]],n]):$t.push([e.state.name,"keyPress",oa[0][0],oa[0][1],null,e.state.curr_table,oa[0][0]+1,Yt[oa[0][1]],n])),e.check_cell_change());console.log($t)},e.store_training_data=function(){$t.push([e.state.name,"END_TRAINING_DATA",null,null,null,e.state.curr_table,null,null,"END"]);var t={user_actions:$t},a={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action_package:t})};fetch("/training/send-training-data/management",a)},e.select_simulation=function(t){"academic"==t.target.name&&e.setState({redirect_link:"/academic"}),"financing"==t.target.name&&e.setState({redirect_link:"/financing"}),"management"==t.target.name&&e.setState({redirect_link:"/management"}),e.toggleRedirectConfirmModal()},e.toggle=function(t){e.state.activeTab!==t&&e.setState({activeTab:t}),"1"===t?(e.setState({curr_table:"schedule_v1"}),Yt=Kt):"2"===t?(e.setState({curr_table:"schedule_v2"}),Yt=Xt):"3"===t&&(e.setState({curr_table:"progress_log"}),Yt=qt)},e.load_tables=function(t){t.preventDefault(),Vt?e.toggleInstructionModal():(Vt=!0,Ft.load_simulation_v2(1,"employee_schedule_v1",Bt,ta,Kt),Ft.load_simulation_v2(1,"employee_schedule_v2",Jt,ta,Xt),Ft.load_simulation_v2(1,"progress_log",Wt,ta,qt),setTimeout((function(){Bt=[Kt].concat(Bt),Jt=[Xt].concat(Jt),Wt=[qt].concat(Wt),e.toggleInstructionModal()}),500),Yt=Kt,e.toggleNameModal())},e.reload_tables=function(){Ft.load_simulation_v2(1,"employee_schedule_v1",Bt,ta,Kt),Ft.load_simulation_v2(1,"employee_schedule_v2",Jt,ta,Xt),Ft.load_simulation_v2(1,"progress_log",Wt,ta,qt),setTimeout((function(){Bt=[Kt].concat(Bt),Jt=[Xt].concat(Jt),Wt=[qt].concat(Wt)}),500),Yt=Kt},e.redirect=function(t){t.preventDefault(),e.setState({redirect:!0})},e.onNameSubmit=function(t){e.setState(Object(y.a)({},t.target.name,t.target.value))},e.submitName=function(t){t.preventDefault(),console.log("state name is: ",e.state.name),e.toggleNameModal()},e.restart=function(){Bt=[],Jt=[],Wt=[],Kt=[],Xt=[],qt=[],e.reload_tables(),$t=[],e.setState({activeTab:"1"}),e.toggle("1"),e.toggleRestartModal()},e.id="hot",e.hotTableComponent=r.a.createRef(),e.hotTableComponent1=r.a.createRef(),e.hotTableComponent2=r.a.createRef(),e.state={collapsed:!1,items:Array.from({length:0}),hasMore:!1,load_from_buffer_to_matrix:!1,hasMoreResult:!1,resultItems:Array.from({length:0}),load_result_from_buffer_to_matrix:!1,redirect_import_page:!1,import_page_link:"/result",data_original:[],check_cell_update:!1,test_block:"ORIGINAL MESSAGE",users:[],user_text_block:"",isSelectPromptOpen:!0,user_name:"",edit_message:"Last Edit: No modification yet",history:[],isShowHistoryOpen:!1,transaction_mode:!1,isSharedLockRejectOpen:!1,isExclusiveLockRejectOpen:!1,isInstructionOpen:!0,activeTab:"1",redirect_link:"",isRedirectConfirmOpen:!1,redirect:!1,isRestartModalOpen:!1},e.socket=B()("localhost:3001"),e.socket.on("RECEIVE_MESSAGE",(function(e){g(e)})),e.socket.on("RECEIVE_ID",(function(e){o(e)})),e.socket.on("REQUEST_SHARED_REJECT",(function(e){h(e)})),e.socket.on("REQUEST_SHARED_ACCEPT",(function(e){var t=e.row,a=e.col;c(t,a)})),e.socket.on("REQUEST_EXCLUSIVE_REJECT",(function(e){var t=e.row,a=e.col;d(t,a)})),e.socket.on("REQUEST_EXCLUSIVE_ACCEPT",(function(e){var t=e.row,a=e.col;e.id!==ga&&i(t,a)})),e.socket.on("CHANGE_CURRENT_USER",(function(e){m(e)})),e.socket.on("ADD_NEW_USER",(function(e){l(e)})),e.socket.on("UPDATE_EDIT_MESSAGE",(function(e){n(e)}));var n=function(t){e.setState({edit_message:t.new_message,history:t.history})},o=function(e){ga=e},l=function(t){e.setState({history:t.history}),m(t.current_users)},s=function(){console.log("setting to read only..."),e.hotTableComponent.current.hotInstance.updateSettings({cells:function(e,t,a){var n={};return console.log("undefined is: ",na[e][t]," ",e," ",t),null===na[e][t]||0===na[e][t].length||"-----"!=na[e][t]&&"*"!==na[e][t].charAt(0)||(n.readOnly="true"),n}})},c=function(t,a){if(t<na.length){var n=e.hotTableComponent.current.hotInstance.getDataAtCell(t,a);if("*"===n.charAt(0))return;var o="*"+n;e.hotTableComponent.current.hotInstance.setDataAtCell(t,a,o),s()}},i=function(t,a){if(t<na.length){console.log(t),console.log(a);e.hotTableComponent.current.hotInstance.setDataAtCell(t,a,"-----"),s()}},h=function(t){e.setState({isSharedLockRejectOpen:!e.state.isSharedLockRejectOpen})},d=function(t){e.setState({isExclusiveLockRejectOpen:!e.state.isExclusiveLockRejectOpen})},m=function(t){e.setState({users:t});for(var a="Currently Online: ",n=0;n<e.state.users.length;n++)n==e.state.users.length-1?a+=e.state.users[n]:a+=e.state.users[n]+", ";e.setState({user_text_block:a})},g=function(t){for(var a=t.data,n=0;n<a.length;n++){var o=a[n][0]-1,l=a[n][1],s=a[n][2]-1;s<na.length?(na[s][o]=l,e.state.data_original[s][o]=l):s+1<1&&(s++,ta[s+50-1][o]!=l&&(ta[s+50-1][o]=l,ea[s+50-1][o]=l))}console.log("after socket, buffer_copy is: ",ta),e.setState({test_block:t.try_message})};return e.toggleSelectionPrompt=e.toggleSelectionPrompt.bind(),e.toggleShowHistory=e.toggleShowHistory.bind(),e.toggleNavbar=e.toggleNavbar.bind(),e.toggleExclusiveLockReject=e.toggleExclusiveLockReject.bind(),e.toggleInstructionModal=e.toggleInstructionModal.bind(),e.toggleRedirectConfirmModal=e.toggleRedirectConfirmModal.bind(),e.toggleNameModal=e.toggleNameModal.bind(),e.toggleRestartModal=e.toggleRestartModal.bind(),e}return Object(h.a)(a,[{key:"componentDidMount",value:function(){var e=Object(E.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Zt=Date.now()/1e3,da=r.a.createElement(k.a,{size:"lg",className:"display-button",color:"primary",onClick:this.start_transaction},"Start Transaction"),this.hotTableComponent.current.hotInstance.addHook("afterChange",(function(e,t){"edit"===t&&(console.log(e),e[0][2]!==e[0][3]&&"*"!==e[0][3].charAt(0)&&"-----"!==e[0][3]&&(console.log("differ!"),oa=e,la=!0,-1,-1,sa=!1))})),this.hotTableComponent.current.hotInstance.addHook("afterBeginEditing",(function(e,t){e,t})),this.hotTableComponent.current.hotInstance.addHook("afterSelection",(function(e,t,a,n,o,l){ua=e,ha=t,sa=!0})),this.hotTableComponent.current.hotInstance.addHook("afterCreateRow",(function(e,t,a){console.log("insert index is: ",e),"ContextMenu.rowBelow"==a?(Qt.layout_changed=!0,Qt.changes.push(["insert_r","below",e])):(Qt.layout_changed=!0,Qt.changes.push(["insert_r","above",e]))})),this.hotTableComponent.current.hotInstance.addHook("afterCreateCol",(function(e,t,a){console.log("insert index is: ",e),"ContextMenu.columnRight"==a?(Qt.layout_changed=!0,Qt.changes.push(["insert_c","right",e])):(Qt.layout_changed=!0,Qt.changes.push(["insert_c","left",e]))})),this.hotTableComponent.current.hotInstance.addHook("afterRemoveRow",(function(e,t,a,n){Qt.layout_changed=!0,Qt.changes.push(["remove_r",null,e])})),this.hotTableComponent.current.hotInstance.addHook("afterRemoveCol",(function(e,t,a,n){Qt.layout_changed=!0,Qt.changes.push(["remove_c",null,e])})),this.hotTableComponent1.current.hotInstance.addHook("afterChange",(function(e,t){"edit"===t&&(console.log(e),e[0][2]!==e[0][3]&&"*"!==e[0][3].charAt(0)&&"-----"!==e[0][3]&&(console.log("differ!"),oa=e,la=!0,-1,-1,sa=!1))})),this.hotTableComponent1.current.hotInstance.addHook("afterBeginEditing",(function(e,t){e,t})),this.hotTableComponent1.current.hotInstance.addHook("afterSelection",(function(e,t,a,n,o,l){ua=e,ha=t,sa=!0})),this.hotTableComponent1.current.hotInstance.addHook("afterCreateRow",(function(e,t,a){console.log("insert index is: ",e),"ContextMenu.rowBelow"==a?(Qt.layout_changed=!0,Qt.changes.push(["insert_r","below",e])):(Qt.layout_changed=!0,Qt.changes.push(["insert_r","above",e]))})),this.hotTableComponent1.current.hotInstance.addHook("afterCreateCol",(function(e,t,a){console.log("insert index is: ",e),"ContextMenu.columnRight"==a?(Qt.layout_changed=!0,Qt.changes.push(["insert_c","right",e])):(Qt.layout_changed=!0,Qt.changes.push(["insert_c","left",e]))})),this.hotTableComponent1.current.hotInstance.addHook("afterRemoveRow",(function(e,t,a,n){Qt.layout_changed=!0,Qt.changes.push(["remove_r",null,e])})),this.hotTableComponent1.current.hotInstance.addHook("afterRemoveCol",(function(e,t,a,n){Qt.layout_changed=!0,Qt.changes.push(["remove_c",null,e])})),this.hotTableComponent2.current.hotInstance.addHook("afterChange",(function(e,t){"edit"===t&&(console.log(e),e[0][2]!==e[0][3]&&"*"!==e[0][3].charAt(0)&&"-----"!==e[0][3]&&(console.log("differ!"),oa=e,la=!0,-1,-1,sa=!1))})),this.hotTableComponent2.current.hotInstance.addHook("afterBeginEditing",(function(e,t){e,t})),this.hotTableComponent2.current.hotInstance.addHook("afterSelection",(function(e,t,a,n,o,l){ua=e,ha=t,sa=!0})),this.hotTableComponent2.current.hotInstance.addHook("afterCreateRow",(function(e,t,a){console.log("insert index is: ",e),"ContextMenu.rowBelow"==a?(Qt.layout_changed=!0,Qt.changes.push(["insert_r","below",e])):(Qt.layout_changed=!0,Qt.changes.push(["insert_r","above",e]))})),this.hotTableComponent2.current.hotInstance.addHook("afterCreateCol",(function(e,t,a){console.log("insert index is: ",e),"ContextMenu.columnRight"==a?(Qt.layout_changed=!0,Qt.changes.push(["insert_c","right",e])):(Qt.layout_changed=!0,Qt.changes.push(["insert_c","left",e]))})),this.hotTableComponent2.current.hotInstance.addHook("afterRemoveRow",(function(e,t,a,n){Qt.layout_changed=!0,Qt.changes.push(["remove_r",null,e])})),this.hotTableComponent2.current.hotInstance.addHook("afterRemoveCol",(function(e,t,a,n){Qt.layout_changed=!0,Qt.changes.push(["remove_c",null,e])}));case 23:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){this.socket.disconnect()}},{key:"render",value:function(){var e,t,a,n=this;return this.state.redirect?r.a.createElement(f.a,{to:this.state.redirect_link}):r.a.createElement("div",{onClick:function(e){return n.track_action(e,"click")},onKeyUp:function(e){return n.track_action(e,"key_press")},className:"App"},r.a.createElement("script",{src:"node_modules/handsontable/dist/handsontable.full.min.js"}),r.a.createElement("link",{href:"node_modules/handsontable/dist/handsontable.full.min.css",rel:"stylesheet",media:"screen"}),r.a.createElement(v.a,{className:"logo-jumbo"},r.a.createElement(st.a,{isOpen:this.state.collapsed,toggle:this.toggleNavbar,style:{float:"left"},className:"up-margin-one"},r.a.createElement(rt.a,{color:"#61dafb",caret:!0,style:{float:"right"}},"Change Simulation"),r.a.createElement(ct.a,null,r.a.createElement(it.a,{name:"academic",id:"academic",onClick:function(e){return n.select_simulation(e)}},"Academic Simulation"),r.a.createElement(it.a,{divider:!0}),r.a.createElement(it.a,{name:"financing",id:"financing",onClick:function(e){return n.select_simulation(e)}},"Financing Simulation")))),r.a.createElement("div",null,r.a.createElement(v.a,null,r.a.createElement("h1",{className:"display-3"},"Hi ",this.state.user_name,", welcome to Management Simulation!"),r.a.createElement("p",{className:"lead"},"This is a simple web interface that allows you to upload spreadsheets and retrieve data."),r.a.createElement("hr",{className:"my-2"}),r.a.createElement("p",{className:"lead"},"\xa0\xa0\xa0\xa0",da,"\xa0\xa0\xa0\xa0",r.a.createElement(k.a,{size:"lg",className:"display-button",color:"info",onClick:this.store_training_data},"Complete Simulation"),"\xa0\xa0\xa0\xa0",r.a.createElement(k.a,{size:"lg",className:"display-button",color:"info",onClick:this.restart},"Restart Simulation"),"\xa0\xa0\xa0\xa0",r.a.createElement(k.a,{size:"lg",className:"display-button",color:"info",onClick:this.toggleInstructionModal},"Instruction")),r.a.createElement(N.a,{size:"lg",isOpen:this.state.isInstructionOpen},r.a.createElement(x.a,null,r.a.createElement("h2",null,"Welcome"),'Welcome to Management Simulation! This instruction can be accessed at any time by clicking the "Instruction" button on this webpage. Under this simulation, there are three tables: an employee schedule table, an enployee shifts table, and a task list. This simulation has three parts.',r.a.createElement("hr",{className:"my-2"}),r.a.createElement("p",{className:"margin-one"},r.a.createElement("h2",null,"Part 1"),'For Part 1 of this simulation, you are to fill out the employee schedule table. Based on the "weekly employee working schedule" we emailed you (if you did not receive our email, please contact ninghan2@illinois.edu), fill out the weekly schedule table for each employee.',r.a.createElement("h5",null,"Note: "),"Make sure to fill out the employee schedule table employee-by-employee (i.e. row-by-row). It is not necessary to order the employees the same way as they are ordered in our emailed schedule, but please follow a row-by-row manner when filling out this table."),r.a.createElement("hr",{className:"my-2"}),r.a.createElement("p",{className:"margin-one"},r.a.createElement("h2",null,"Part 2"),'In part 2, you are to fill out the employee shift table based the "daily employee shifts" we emailed you (again, if you did not received the email, please contact ninghan2@illinois.edu).',r.a.createElement("h5",null,"Note: "),"Make sure to fill out the employee shifts table day-by-day. That is, you need to fill out all the shifts on Monday before starting to fill out the shifts on Tuesday.")),r.a.createElement(P.a,null,r.a.createElement(k.a,{size:"lg",className:"display-button",color:"info",onClick:this.load_tables},"Got it!"))),r.a.createElement(N.a,{size:"lg",isOpen:this.state.isRedirectConfirmOpen,toggle:this.toggleRedirectConfirmModal},r.a.createElement(I.a,{toggle:this.toggleRedirectConfirmModal},"Are you sure you want to leave this page?"),r.a.createElement(x.a,null,"Note that once you leave this simulation page, you will lose all the records and progress on this simulation."),r.a.createElement(P.a,null,r.a.createElement(k.a,{size:"lg",className:"display-button",color:"info",onClick:this.redirect},"Confirm")," "," ",r.a.createElement(k.a,{size:"lg",className:"display-button",color:"info",onClick:this.toggleRedirectConfirmModal},"Cancel"))),r.a.createElement(N.a,{size:"lg",isOpen:this.state.isNameModalOpen,toggle:this.toggleNameModal},r.a.createElement(I.a,{toggle:this.toggleNameModal},"Please Enter Your Full Name"),r.a.createElement(x.a,null,r.a.createElement(j.a,{onSubmit:this.submitName},r.a.createElement(A.a,null,r.a.createElement(H.a,{for:"user_name"},"Enter Full Name"),r.a.createElement(D.a,{type:"text",name:"name",id:"name",onChange:function(e){return n.onNameSubmit(e)}})),r.a.createElement(k.a,{size:"lg",color:"primary",className:"single_search_submit",type:"submit"},"Confirm")," "," "))),r.a.createElement(N.a,{size:"lg",isOpen:this.state.isRestartModalOpen,toggle:this.toggleRestartModal},r.a.createElement(I.a,{toggle:this.toggleRestartModal},"Please Enter Your Full Name"),r.a.createElement(x.a,null,"Your simulation has been restarted. All the changes that haven't been committed yet are clearned."),r.a.createElement(P.a,null,r.a.createElement(k.a,{size:"lg",className:"display-button",color:"info",onClick:this.toggleRestartModal},"Got It"))))),r.a.createElement(M.a,{tabs:!0},r.a.createElement(w.a,null,r.a.createElement(T.a,{className:mt()({active:"1"===this.state.activeTab}),onClick:function(){n.toggle("1")}},"Employee Schedule")),r.a.createElement(w.a,null,r.a.createElement(T.a,{className:mt()({active:"2"===this.state.activeTab}),onClick:function(){n.toggle("2")}},"Employee Shifts")),r.a.createElement(w.a,null,r.a.createElement(T.a,{className:mt()({active:"3"===this.state.activeTab}),onClick:function(){n.toggle("3")}},"Task List"))),r.a.createElement(ut.a,{activeTab:this.state.activeTab},r.a.createElement(ht.a,{tabId:"1"},r.a.createElement("h4",null,"Employee Weekly Schedule"),r.a.createElement("div",{id:"display_portion",onScroll:function(e){return n.track_action(e,"scroll")},tabIndex:"1"},r.a.createElement(S.a,(e={className:"handsontable",id:"display_table",data:Bt,ref:this.hotTableComponent},Object(y.a)(e,"id",this.id),Object(y.a)(e,"colHeaders",!0),Object(y.a)(e,"rowHeaders",!0),Object(y.a)(e,"width","100%"),Object(y.a)(e,"height","300"),Object(y.a)(e,"colWidths","100%"),Object(y.a)(e,"rowHeights","25"),Object(y.a)(e,"contextMenu",!0),Object(y.a)(e,"formulas",!0),Object(y.a)(e,"readOnly",!this.state.transaction_mode),e)))),r.a.createElement(ht.a,{tabId:"2"},r.a.createElement("h4",null,"Employee Shifts Schedule"),r.a.createElement("div",{id:"display_portion",onScroll:function(e){return n.track_action(e,"scroll")},tabIndex:"1"},r.a.createElement(S.a,(t={className:"handsontable",id:"display_table",data:Jt,ref:this.hotTableComponent1},Object(y.a)(t,"id",this.id),Object(y.a)(t,"colHeaders",!0),Object(y.a)(t,"rowHeaders",!0),Object(y.a)(t,"width","100%"),Object(y.a)(t,"height","300"),Object(y.a)(t,"colWidths","100%"),Object(y.a)(t,"rowHeights","25"),Object(y.a)(t,"contextMenu",!0),Object(y.a)(t,"formulas",!0),Object(y.a)(t,"readOnly",!this.state.transaction_mode),t)))),r.a.createElement(ht.a,{tabId:"3"},r.a.createElement("h4",null,"Projects Progress Table"),r.a.createElement("div",{id:"display_portion",onScroll:function(e){return n.track_action(e,"scroll")},tabIndex:"1"},r.a.createElement(S.a,(a={className:"handsontable",id:"display_table",data:Wt,ref:this.hotTableComponent2},Object(y.a)(a,"id",this.id),Object(y.a)(a,"colHeaders",!0),Object(y.a)(a,"rowHeaders",!0),Object(y.a)(a,"width","100%"),Object(y.a)(a,"height","300"),Object(y.a)(a,"colWidths","100%"),Object(y.a)(a,"rowHeights","25"),Object(y.a)(a,"contextMenu",!0),Object(y.a)(a,"formulas",!0),Object(y.a)(a,"readOnly",!this.state.transaction_mode),a))))))}}]),a}(s.Component),fa=new(a(198)),_a=[],ba=[],Ea=[],ya=!1,Sa=(new(a(135)),{layout_changed:!1,changes:[]}),ka=[],va=[],Ca=[],Oa=[],Ra=[],Ma=0,wa=[],Ta=[],Na=0,Ia=[],xa=[],ja=!1,Aa=!1,Ha=-1,Da=-1,La="",Pa=-1,Ua=-1,za="",Ga={data:[],try_message:"SENT MESSAGE! SUCCESS!",user:""},Fa="",Ba=function(e){Object(d.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(u.a)(this,a),(e=t.call(this)).request_shared_lock=function(){var t={row:Pa,col:Ua};e.socket.emit("REQUEST_SHARED_LOCK",t)},e.request_exclusive_lock=function(t,a){var n={row:t,col:a};e.socket.emit("REQUEST_EXCLUSIVE_LOCK",n)},e.toggleRestartModal=function(){e.setState({isRestartModalOpen:!e.state.isRestartModalOpen})},e.toggleNameModal=function(){e.setState({isNameModalOpen:!e.state.isNameModalOpen})},e.toggleRedirectConfirmModal=function(){e.setState({isRedirectConfirmOpen:!e.state.isRedirectConfirmOpen})},e.toggleNavbar=function(){e.setState({collapsed:!e.state.collapsed})},e.toggleExclusiveLockReject=function(){e.setState({isExclusiveLockRejectOpen:!e.state.isExclusiveLockRejectOpen})},e.toggleShowHistory=function(){e.setState({isShowHistoryOpen:!e.state.isShowHistoryOpen})},e.toggleSelectionPrompt=function(){e.setState({isSelectPromptOpen:!e.state.isSelectPromptOpen})},e.toggleInstructionModal=function(){e.setState({isInstructionOpen:!e.state.isInstructionOpen})},e.display=function(){"",za=e.state.transaction_mode?r.a.createElement(k.a,{size:"lg",className:"display-button",color:"primary",onClick:e.end_transaction},"End Transaction"):r.a.createElement(k.a,{size:"lg",className:"display-button",color:"primary",onClick:e.start_transaction},"Start Transaction"),e.setState({data_original:e.state.data_original.concat(wa)}),0==Ia.length&&Ia.push(ka),Ia=Ia.concat(Ta),console.log("data display is: ",Ia)},e.redirect_import=function(){e.setState({redirect_import_page:!0})},e.handleScroll=function(e){e.target.scrollHeight,e.target.scrollTop,e.target.clientHeight;Na=e.target.scrollTop},e.show_state=function(){console.log(xa),console.log(ja)},e.sendMessage=function(t){e.socket.emit("SEND_MESSAGE",t)},e.check_cell_change=function(){if(ja){var t="Y";e.state.transaction_mode||(t="N");var a="";a=isNaN(xa[0][3])?"STR":"DIGIT",Ra.push([e.state.name,"edit_cell",xa[0][0],xa[0][1],a,e.state.curr_table,xa[0][0]+1,ka[xa[0][1]],t]),Ga.user=e.state.user_name;var n=[],o=parseInt(xa[0][0])+1,l=parseInt(xa[0][1])+1,s=xa[0][3];n[0]=l,n[1]=s,n[2]=o,Ga.data.push(n),ja=!1}else console.log("no changed detected")},e.cell_read_only=function(t,a){e.hotTableComponent.current.hotInstance.updateSettings({cells:function(e,n,o){var l={};return e==t&&n==a&&(l.readOnly="true"),l}})},e.hangleUsername=function(t){e.setState(Object(y.a)({},t.target.name,t.target.value))},e.send_default_username=function(){e.socket.emit("SEND_USERNAME",{user_name:"anonymous user"}),e.toggleUserNamePrompt()},e.onSelectionSubmit=function(t){t.preventDefault(),console.log("call username");var a={user_name:e.state.user_name};e.socket.emit("SEND_USERNAME",a),e.toggleUserNamePrompt()},e.resolve_conflict=function(t){t.preventDefault(),Ia[Ha][Da]=La,e.state.data_original[Ha][Da]=La,Ha=-1,Da=-1,La=-1,"",e.toggleConflictModal()},e.start_transaction=function(){Ga.data=[],e.setState({transaction_mode:!0}),za=r.a.createElement(k.a,{size:"lg",className:"display-button",color:"primary",onClick:e.end_transaction},"End Transaction")},e.end_transaction=function(){e.setState({transaction_mode:!1}),za=r.a.createElement(k.a,{size:"lg",className:"display-button",color:"primary",onClick:e.start_transaction},"Start Transaction")},e.track_action=function(t,a){var n="Y";e.state.transaction_mode||(n="N");var o=Date.now()/1e3-Ma;if(Ma=Date.now()/1e3,o>3)if(Ra.length>0&&"idle"==Ra[Ra.length-1][1]){var l=Ra[Ra.length-1][2];Ra.pop(),Ra.push([e.state.name,"idle",parseInt(o)+l,null,null,e.state.curr_table,null,null,n])}else Ra.push([e.state.name,"idle",parseInt(o),null,null,e.state.curr_table,null,null,n]);if(Sa.layout_changed){Ra.length>0&&"idle"==Ra[Ra.length-1][1]&&Ra.pop();for(var s=0;s<Sa.changes.length;s++){var r=Sa.changes[s][0],c=Sa.changes[s][1],i=Sa.changes[s][2];Ra.push([e.state.name,r,i,c,null,e.state.curr_table,null,null,n])}Sa.changes.length=0,Sa.layout_changed=!1}if("scroll"==a){var u=Na-t.target.scrollTop,h=Ra.length;if(u>0)if(h>=1&&"up_scroll_l"===Ra[h-1][1]);else if(h>=5){var d=!0;for(s=0;s<5;s++)if("up_scroll_s"!==Ra[h-1-s][1]){d=!1;break}if(d){for(s=0;s<5;s++)Ra.pop();Ra.push([e.state.name,"up_scroll_l",null,null,null,e.state.curr_table,null,null,n])}else Ra.push([e.state.name,"up_scroll_s",null,null,null,e.state.curr_table,null,null,n])}else Ra.push([e.state.name,"up_scroll_s",null,null,null,e.state.curr_table,null,null,n]);else if(u<0)if(h>=1&&"down_scroll_l"===Ra[h-1][1]);else if(h>=5){var m=!0;for(s=0;s<5;s++)if("down_scroll_s"!==Ra[h-1-s][1]){m=!1;break}if(m){for(s=0;s<5;s++)Ra.pop();Ra.push([e.state.name,"down_scroll_l",null,null,null,e.state.curr_table,null,null,n])}else Ra.push([e.state.name,"down_scroll_s",null,null,null,e.state.curr_table,null,null,n])}else Ra.push([e.state.name,"down_scroll_s",null,null,null,e.state.curr_table,null,null,n]);e.handleScroll(t)}else"click"==a?(Aa&&(Ua<0?Ra.push([e.state.name,"select_r",Pa,null,null,e.state.curr_table,null,null,n]):Pa<0?Ra.push([e.state.name,"select_c",Ua,null,null,e.state.curr_table,null,null,n]):Ra.push([e.state.name,a,Pa,Ua,null,e.state.curr_table,Pa+1,ka[Ua],n]),Aa=!1),e.check_cell_change()):"key_press"==a&&(ja&&("Enter"==t.key?Ra.push([e.state.name,"keyPress_enter",xa[0][0],xa[0][1],null,e.state.curr_table,xa[0][0]+1,ka[xa[0][1]],n]):"Tab"==t.key?Ra.push([e.state.name,"keyPress_tab",xa[0][0],xa[0][1],null,e.state.curr_table,xa[0][0]+1,ka[xa[0][1]],n]):Ra.push([e.state.name,"keyPress",xa[0][0],xa[0][1],null,e.state.curr_table,xa[0][0]+1,ka[xa[0][1]],n])),e.check_cell_change());console.log(Ra)},e.store_training_data=function(){Ra.push([e.state.name,"END_TRAINING_DATA",null,null,null,e.state.curr_table,null,null,"END"]);var t={user_actions:Ra},a={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action_package:t})};fetch("/training/send-training-data/financing",a)},e.select_simulation=function(t){"academic"==t.target.name&&e.setState({redirect_link:"/academic"}),"financing"==t.target.name&&e.setState({redirect_link:"/financing"}),"management"==t.target.name&&e.setState({redirect_link:"/management"}),e.toggleRedirectConfirmModal()},e.toggle=function(t){e.state.activeTab!==t&&e.setState({activeTab:t}),"1"===t?(e.setState({curr_table:"monthly_expenses"}),ka=va):"2"===t?(e.setState({curr_table:"montly_income"}),ka=Ca):"3"===t&&(e.setState({curr_table:"check_book"}),ka=Oa)},e.load_tables=function(t){t.preventDefault(),ya?e.toggleInstructionModal():(ya=!0,fa.load_simulation_v2(1,"monthly_expense",_a,Ta,va),fa.load_simulation_v2(1,"monthly_income",ba,Ta,Ca),fa.load_simulation_v2(1,"check_book",Ea,Ta,Oa),setTimeout((function(){_a=[va].concat(_a),ba=[Ca].concat(ba),Ea=[Oa].concat(Ea),e.toggleInstructionModal()}),500),ka=va,e.toggleNameModal())},e.reload_tables=function(){fa.load_simulation_v2(1,"monthly_expense",_a,Ta,va),fa.load_simulation_v2(1,"monthly_income",ba,Ta,Ca),fa.load_simulation_v2(1,"check_book",Ea,Ta,Oa),setTimeout((function(){_a=[va].concat(_a),ba=[Ca].concat(ba),Ea=[Oa].concat(Ea)}),500),ka=va},e.redirect=function(t){t.preventDefault(),e.setState({redirect:!0})},e.onNameSubmit=function(t){e.setState(Object(y.a)({},t.target.name,t.target.value))},e.submitName=function(t){t.preventDefault(),console.log("state name is: ",e.state.name),e.toggleNameModal()},e.restart=function(){_a=[],ba=[],Ea=[],va=[],Ca=[],Oa=[],e.reload_tables(),Ra=[],e.setState({activeTab:"1"}),e.toggle("1"),e.toggleRestartModal()},e.id="hot",e.hotTableComponent=r.a.createRef(),e.hotTableComponent1=r.a.createRef(),e.hotTableComponent2=r.a.createRef(),e.state={collapsed:!1,items:Array.from({length:0}),hasMore:!1,load_from_buffer_to_matrix:!1,hasMoreResult:!1,resultItems:Array.from({length:0}),load_result_from_buffer_to_matrix:!1,redirect_import_page:!1,import_page_link:"/result",data_original:[],check_cell_update:!1,test_block:"ORIGINAL MESSAGE",users:[],user_text_block:"",isSelectPromptOpen:!0,user_name:"",edit_message:"Last Edit: No modification yet",history:[],isShowHistoryOpen:!1,transaction_mode:!1,isSharedLockRejectOpen:!1,isExclusiveLockRejectOpen:!1,isInstructionOpen:!0,activeTab:"1",redirect_link:"",isRedirectConfirmOpen:!1,redirect:!1,isRestartModalOpen:!1},e.socket=B()("localhost:3001"),e.socket.on("RECEIVE_MESSAGE",(function(e){g(e)})),e.socket.on("RECEIVE_ID",(function(e){o(e)})),e.socket.on("REQUEST_SHARED_REJECT",(function(e){h(e)})),e.socket.on("REQUEST_SHARED_ACCEPT",(function(e){var t=e.row,a=e.col;c(t,a)})),e.socket.on("REQUEST_EXCLUSIVE_REJECT",(function(e){var t=e.row,a=e.col;d(t,a)})),e.socket.on("REQUEST_EXCLUSIVE_ACCEPT",(function(e){var t=e.row,a=e.col;e.id!==Fa&&i(t,a)})),e.socket.on("CHANGE_CURRENT_USER",(function(e){m(e)})),e.socket.on("ADD_NEW_USER",(function(e){l(e)})),e.socket.on("UPDATE_EDIT_MESSAGE",(function(e){n(e)}));var n=function(t){e.setState({edit_message:t.new_message,history:t.history})},o=function(e){Fa=e},l=function(t){e.setState({history:t.history}),m(t.current_users)},s=function(){console.log("setting to read only..."),e.hotTableComponent.current.hotInstance.updateSettings({cells:function(e,t,a){var n={};return console.log("undefined is: ",Ia[e][t]," ",e," ",t),null===Ia[e][t]||0===Ia[e][t].length||"-----"!=Ia[e][t]&&"*"!==Ia[e][t].charAt(0)||(n.readOnly="true"),n}})},c=function(t,a){if(t<Ia.length){var n=e.hotTableComponent.current.hotInstance.getDataAtCell(t,a);if("*"===n.charAt(0))return;var o="*"+n;e.hotTableComponent.current.hotInstance.setDataAtCell(t,a,o),s()}},i=function(t,a){if(t<Ia.length){console.log(t),console.log(a);e.hotTableComponent.current.hotInstance.setDataAtCell(t,a,"-----"),s()}},h=function(t){e.setState({isSharedLockRejectOpen:!e.state.isSharedLockRejectOpen})},d=function(t){e.setState({isExclusiveLockRejectOpen:!e.state.isExclusiveLockRejectOpen})},m=function(t){e.setState({users:t});for(var a="Currently Online: ",n=0;n<e.state.users.length;n++)n==e.state.users.length-1?a+=e.state.users[n]:a+=e.state.users[n]+", ";e.setState({user_text_block:a})},g=function(t){for(var a=t.data,n=0;n<a.length;n++){var o=a[n][0]-1,l=a[n][1],s=a[n][2]-1;s<Ia.length?(Ia[s][o]=l,e.state.data_original[s][o]=l):s+1<1&&(s++,Ta[s+50-1][o]!=l&&(Ta[s+50-1][o]=l,wa[s+50-1][o]=l))}console.log("after socket, buffer_copy is: ",Ta),e.setState({test_block:t.try_message})};return e.toggleSelectionPrompt=e.toggleSelectionPrompt.bind(),e.toggleShowHistory=e.toggleShowHistory.bind(),e.toggleNavbar=e.toggleNavbar.bind(),e.toggleExclusiveLockReject=e.toggleExclusiveLockReject.bind(),e.toggleInstructionModal=e.toggleInstructionModal.bind(),e.toggleRedirectConfirmModal=e.toggleRedirectConfirmModal.bind(),e.toggleNameModal=e.toggleNameModal.bind(),e.toggleRestartModal=e.toggleRestartModal.bind(),e}return Object(h.a)(a,[{key:"componentDidMount",value:function(){var e=Object(E.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Ma=Date.now()/1e3,za=r.a.createElement(k.a,{size:"lg",className:"display-button",color:"primary",onClick:this.start_transaction},"Start Transaction"),this.hotTableComponent.current.hotInstance.addHook("afterChange",(function(e,t){"edit"===t&&(console.log(e),e[0][2]!==e[0][3]&&"*"!==e[0][3].charAt(0)&&"-----"!==e[0][3]&&(console.log("differ!"),xa=e,ja=!0,-1,-1,Aa=!1))})),this.hotTableComponent.current.hotInstance.addHook("afterBeginEditing",(function(e,t){e,t})),this.hotTableComponent.current.hotInstance.addHook("afterSelection",(function(e,t,a,n,o,l){Pa=e,Ua=t,Aa=!0})),this.hotTableComponent.current.hotInstance.addHook("afterCreateRow",(function(e,t,a){console.log("insert index is: ",e),"ContextMenu.rowBelow"==a?(Sa.layout_changed=!0,Sa.changes.push(["insert_r","below",e])):(Sa.layout_changed=!0,Sa.changes.push(["insert_r","above",e]))})),this.hotTableComponent.current.hotInstance.addHook("afterCreateCol",(function(e,t,a){console.log("insert index is: ",e),"ContextMenu.columnRight"==a?(Sa.layout_changed=!0,Sa.changes.push(["insert_c","right",e])):(Sa.layout_changed=!0,Sa.changes.push(["insert_c","left",e]))})),this.hotTableComponent.current.hotInstance.addHook("afterRemoveRow",(function(e,t,a,n){Sa.layout_changed=!0,Sa.changes.push(["remove_r",null,e])})),this.hotTableComponent.current.hotInstance.addHook("afterRemoveCol",(function(e,t,a,n){Sa.layout_changed=!0,Sa.changes.push(["remove_c",null,e])})),this.hotTableComponent1.current.hotInstance.addHook("afterChange",(function(e,t){"edit"===t&&(console.log(e),e[0][2]!==e[0][3]&&"*"!==e[0][3].charAt(0)&&"-----"!==e[0][3]&&(console.log("differ!"),xa=e,ja=!0,-1,-1,Aa=!1))})),this.hotTableComponent1.current.hotInstance.addHook("afterBeginEditing",(function(e,t){e,t})),this.hotTableComponent1.current.hotInstance.addHook("afterSelection",(function(e,t,a,n,o,l){Pa=e,Ua=t,Aa=!0})),this.hotTableComponent1.current.hotInstance.addHook("afterCreateRow",(function(e,t,a){console.log("insert index is: ",e),"ContextMenu.rowBelow"==a?(Sa.layout_changed=!0,Sa.changes.push(["insert_r","below",e])):(Sa.layout_changed=!0,Sa.changes.push(["insert_r","above",e]))})),this.hotTableComponent1.current.hotInstance.addHook("afterCreateCol",(function(e,t,a){console.log("insert index is: ",e),"ContextMenu.columnRight"==a?(Sa.layout_changed=!0,Sa.changes.push(["insert_c","right",e])):(Sa.layout_changed=!0,Sa.changes.push(["insert_c","left",e]))})),this.hotTableComponent1.current.hotInstance.addHook("afterRemoveRow",(function(e,t,a,n){Sa.layout_changed=!0,Sa.changes.push(["remove_r",null,e])})),this.hotTableComponent1.current.hotInstance.addHook("afterRemoveCol",(function(e,t,a,n){Sa.layout_changed=!0,Sa.changes.push(["remove_c",null,e])})),this.hotTableComponent2.current.hotInstance.addHook("afterChange",(function(e,t){"edit"===t&&(console.log(e),e[0][2]!==e[0][3]&&"*"!==e[0][3].charAt(0)&&"-----"!==e[0][3]&&(console.log("differ!"),xa=e,ja=!0,-1,-1,Aa=!1))})),this.hotTableComponent2.current.hotInstance.addHook("afterBeginEditing",(function(e,t){e,t})),this.hotTableComponent2.current.hotInstance.addHook("afterSelection",(function(e,t,a,n,o,l){Pa=e,Ua=t,Aa=!0})),this.hotTableComponent2.current.hotInstance.addHook("afterCreateRow",(function(e,t,a){console.log("insert index is: ",e),"ContextMenu.rowBelow"==a?(Sa.layout_changed=!0,Sa.changes.push(["insert_r","below",e])):(Sa.layout_changed=!0,Sa.changes.push(["insert_r","above",e]))})),this.hotTableComponent2.current.hotInstance.addHook("afterCreateCol",(function(e,t,a){console.log("insert index is: ",e),"ContextMenu.columnRight"==a?(Sa.layout_changed=!0,Sa.changes.push(["insert_c","right",e])):(Sa.layout_changed=!0,Sa.changes.push(["insert_c","left",e]))})),this.hotTableComponent2.current.hotInstance.addHook("afterRemoveRow",(function(e,t,a,n){Sa.layout_changed=!0,Sa.changes.push(["remove_r",null,e])})),this.hotTableComponent2.current.hotInstance.addHook("afterRemoveCol",(function(e,t,a,n){Sa.layout_changed=!0,Sa.changes.push(["remove_c",null,e])}));case 23:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){this.socket.disconnect()}},{key:"render",value:function(){var e,t,a,n=this;return this.state.redirect?r.a.createElement(f.a,{to:this.state.redirect_link}):r.a.createElement("div",{onClick:function(e){return n.track_action(e,"click")},onKeyUp:function(e){return n.track_action(e,"key_press")},className:"App"},r.a.createElement("script",{src:"node_modules/handsontable/dist/handsontable.full.min.js"}),r.a.createElement("link",{href:"node_modules/handsontable/dist/handsontable.full.min.css",rel:"stylesheet",media:"screen"}),r.a.createElement(v.a,{className:"logo-jumbo"},r.a.createElement(st.a,{isOpen:this.state.collapsed,toggle:this.toggleNavbar,style:{float:"left"},className:"up-margin-one"},r.a.createElement(rt.a,{color:"#61dafb",caret:!0,style:{float:"right"}},"Change Simulation"),r.a.createElement(ct.a,null,r.a.createElement(it.a,{name:"academic",id:"academic",onClick:function(e){return n.select_simulation(e)}},"Academic Simulation"),r.a.createElement(it.a,{divider:!0}),r.a.createElement(it.a,{name:"management",id:"management",onClick:function(e){return n.select_simulation(e)}},"Management Simulation")))),r.a.createElement("div",null,r.a.createElement(v.a,null,r.a.createElement("h1",{className:"display-3"},"Hi ",this.state.user_name,", welcome to Financing Simulation!"),r.a.createElement("p",{className:"lead"},"This is a simple web interface that allows you to upload spreadsheets and retrieve data."),r.a.createElement("hr",{className:"my-2"}),r.a.createElement("p",{className:"lead"},"\xa0\xa0\xa0\xa0",za,"\xa0\xa0\xa0\xa0",r.a.createElement(k.a,{size:"lg",className:"display-button",color:"info",onClick:this.store_training_data},"Complete Simulation"),"\xa0\xa0\xa0\xa0",r.a.createElement(k.a,{size:"lg",className:"display-button",color:"info",onClick:this.restart},"Restart Simulation"),"\xa0\xa0\xa0\xa0",r.a.createElement(k.a,{size:"lg",className:"display-button",color:"info",onClick:this.toggleInstructionModal},"Instruction")),r.a.createElement(N.a,{size:"lg",isOpen:this.state.isInstructionOpen},r.a.createElement(x.a,null,r.a.createElement("h2",null,"Welcome"),'Welcome to Academic Simulation! This instruction can be accessed at any time by clicking the "Instruction" button on this webpage. Under this simulation, there are three tables: a monthly expense table, a monthly income table, and a transaction table',r.a.createElement("hr",{className:"my-2"}),r.a.createElement("p",{className:"margin-one"},r.a.createElement("h2",null,"Procedures"),'You are given a list of expenditures and earnings with corresponding data and discriptions from our email (If you didn\'t receive our email for the list, please contact ninghan2@illinois.edu). Following that list from top to bottom (i.e. oldest to most recent), for each entry, you are to first log that entry into the transanction table by filling out the corresponding coloum. For an expenditure, leave the "deposit" plank, and for an income, leave the "withdraw" plank. Also for each entry, you need to manually calculate the remaining balance, assuming that your initial balance is $10,000. For each entry that you log into the transaction table, update the monthly income table or monthly expense table, depending on whether the entry is an expenditure or income.',r.a.createElement("h5",null,"Note: "),"Make sure to follow the procedures entry-by-entry from the list we send you from our email. That is, for each entry from the list (from top to bottom), log that entry into the transaction table first, and then update either monthly expense or monthly income table with the correct month and expense/income category. After that, move on the the next entry from the list, and log it into the transaction table...etc. Make sure do not skip procedures. Specifically, DO NOT log multiple entry from the list into the transaction table and do multiple updates on monthly expense or monthly income at once.")),r.a.createElement(P.a,null,r.a.createElement(k.a,{size:"lg",className:"display-button",color:"info",onClick:this.load_tables},"Got it!"))),r.a.createElement(N.a,{size:"lg",isOpen:this.state.isRedirectConfirmOpen,toggle:this.toggleRedirectConfirmModal},r.a.createElement(I.a,{toggle:this.toggleRedirectConfirmModal},"Are you sure you want to leave this page?"),r.a.createElement(x.a,null,"Note that once you leave this simulation page, you will lose all the records and progress on this simulation."),r.a.createElement(P.a,null,r.a.createElement(k.a,{size:"lg",className:"display-button",color:"info",onClick:this.redirect},"Confirm")," "," ",r.a.createElement(k.a,{size:"lg",className:"display-button",color:"info",onClick:this.toggleRedirectConfirmModal},"Cancel"))),r.a.createElement(N.a,{size:"lg",isOpen:this.state.isNameModalOpen,toggle:this.toggleNameModal},r.a.createElement(I.a,{toggle:this.toggleNameModal},"Please Enter Your Full Name"),r.a.createElement(x.a,null,r.a.createElement(j.a,{onSubmit:this.submitName},r.a.createElement(A.a,null,r.a.createElement(H.a,{for:"user_name"},"Enter Full Name"),r.a.createElement(D.a,{type:"text",name:"name",id:"name",onChange:function(e){return n.onNameSubmit(e)}})),r.a.createElement(k.a,{size:"lg",color:"primary",className:"single_search_submit",type:"submit"},"Confirm")," "," "))),r.a.createElement(N.a,{size:"lg",isOpen:this.state.isRestartModalOpen,toggle:this.toggleRestartModal},r.a.createElement(I.a,{toggle:this.toggleRestartModal},"Please Enter Your Full Name"),r.a.createElement(x.a,null,"Your simulation has been restarted. All the changes that haven't been committed yet are clearned."),r.a.createElement(P.a,null,r.a.createElement(k.a,{size:"lg",className:"display-button",color:"info",onClick:this.toggleRestartModal},"Got It"))))),r.a.createElement(M.a,{tabs:!0},r.a.createElement(w.a,null,r.a.createElement(T.a,{className:mt()({active:"1"===this.state.activeTab}),onClick:function(){n.toggle("1")}},"Monthly Expenses")),r.a.createElement(w.a,null,r.a.createElement(T.a,{className:mt()({active:"2"===this.state.activeTab}),onClick:function(){n.toggle("2")}},"Monthly Income")),r.a.createElement(w.a,null,r.a.createElement(T.a,{className:mt()({active:"3"===this.state.activeTab}),onClick:function(){n.toggle("3")}},"Transaction Log"))),r.a.createElement(ut.a,{activeTab:this.state.activeTab},r.a.createElement(ht.a,{tabId:"1"},r.a.createElement("h4",null,"Monthly Expenses Table"),r.a.createElement("div",{id:"display_portion",onScroll:function(e){return n.track_action(e,"scroll")},tabIndex:"1"},r.a.createElement(S.a,(e={className:"handsontable",id:"display_table",data:_a,ref:this.hotTableComponent},Object(y.a)(e,"id",this.id),Object(y.a)(e,"colHeaders",!0),Object(y.a)(e,"rowHeaders",!0),Object(y.a)(e,"width","100%"),Object(y.a)(e,"height","300"),Object(y.a)(e,"colWidths","100%"),Object(y.a)(e,"rowHeights","25"),Object(y.a)(e,"contextMenu",!0),Object(y.a)(e,"formulas",!0),Object(y.a)(e,"readOnly",!this.state.transaction_mode),e)))),r.a.createElement(ht.a,{tabId:"2"},r.a.createElement("h4",null,"Monthly Income Table"),r.a.createElement("div",{id:"display_portion",onScroll:function(e){return n.track_action(e,"scroll")},tabIndex:"1"},r.a.createElement(S.a,(t={className:"handsontable",id:"display_table",data:ba,ref:this.hotTableComponent1},Object(y.a)(t,"id",this.id),Object(y.a)(t,"colHeaders",!0),Object(y.a)(t,"rowHeaders",!0),Object(y.a)(t,"width","100%"),Object(y.a)(t,"height","300"),Object(y.a)(t,"colWidths","100%"),Object(y.a)(t,"rowHeights","25"),Object(y.a)(t,"contextMenu",!0),Object(y.a)(t,"formulas",!0),Object(y.a)(t,"readOnly",!this.state.transaction_mode),t)))),r.a.createElement(ht.a,{tabId:"3"},r.a.createElement("h4",null,"Transaction Log"),r.a.createElement("div",{id:"display_portion",onScroll:function(e){return n.track_action(e,"scroll")},tabIndex:"1"},r.a.createElement(S.a,(a={className:"handsontable",id:"display_table",data:Ea,ref:this.hotTableComponent2},Object(y.a)(a,"id",this.id),Object(y.a)(a,"colHeaders",!0),Object(y.a)(a,"rowHeaders",!0),Object(y.a)(a,"width","100%"),Object(y.a)(a,"height","300"),Object(y.a)(a,"colWidths","100%"),Object(y.a)(a,"rowHeights","25"),Object(y.a)(a,"contextMenu",!0),Object(y.a)(a,"formulas",!0),Object(y.a)(a,"readOnly",!this.state.transaction_mode),a))))))}}]),a}(s.Component),Ja=(new(a(135)),function(e){Object(d.a)(a,e);var t=Object(m.a)(a);function a(){var e;return Object(u.a)(this,a),(e=t.call(this)).toggleSearchSelectionModal=function(){e.setState({isSearchSelectionModalOpen:!e.state.isSearchSelectionModalOpen})},e.toggleRangeSearchModal=function(){e.setState({isRangeSearchModalOpen:!e.state.isRangeSearchModalOpen,isSearchSelectionModalOpen:!e.state.isSearchSelectionModalOpen})},e.toggleSingleSearchModal=function(){e.setState({isSingelSearchModalOpen:!e.state.isSingelSearchModalOpen,isSearchSelectionModalOpen:!e.state.isSearchSelectionModalOpen})},e.onRetrieveSelectionClick=function(){e.toggleSearchSelectionModal()},e.fileHandler=function(t){var a=t.target.files[0];Object(g.ExcelRenderer)(a,(function(t,a){t?console.log(t):e.setState({cols:a.cols,rows:a.rows})}))},e.state={rows:[],cols:[],attri:[],isSearchSelectionModalOpen:!1,isRangeSearchModalOpen:!1,isSingelSearchModalOpen:!1},e.toggleSearchSelectionModal=e.toggleSearchSelectionModal.bind(),e.toggleRangeSearchModal=e.toggleRangeSearchModal.bind(),e.toggleSingleSearchModal=e.toggleSearchSelectionModal.bind(),e}return Object(h.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:"App"},r.a.createElement(p.a,{basename:"/spreadsheetfrontend"},r.a.createElement("div",null,r.a.createElement(f.d,null,r.a.createElement(f.b,{path:"/",component:lt,exact:!0}),r.a.createElement(f.b,{path:"/result",component:xe}),r.a.createElement(f.b,{path:"/start",component:pe}),r.a.createElement(f.b,{path:"/academic",component:Gt}),r.a.createElement(f.b,{path:"/management",component:pa}),r.a.createElement(f.b,{path:"/financing",component:Ba})))))}}]),a}(s.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(466);i.a.render(r.a.createElement(Ja,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[339,1,2]]]);
//# sourceMappingURL=main.8920e7d4.chunk.js.map